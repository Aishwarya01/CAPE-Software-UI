<div *ngIf="tabError" style="text-align: center;">
    <span class="alert alert-danger">{{tabErrorMsg}}</span>
  </div>
<div *ngIf="validationErrorTab" style="text-align: center;">
    <span class="alert alert-danger">{{validationErrorMsgTab}}</span>
  </div>
<div class="card">
    <div class="card-body">
        <form [formGroup]="EMCPowerAndEarthForm" (keyup)="onKeyForm($event)" (change)="onChangeForm($event)"
            (ngSubmit)="savePowerAndEarthingData(flag)">

            <mat-accordion>
                <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                    <mat-expansion-panel-header>
                         <mat-panel-title>
                            <h3>Service Entrance</h3>
                        </mat-panel-title>
                    </mat-expansion-panel-header>

                    <!-- Electrical utility service supplier -->
                    <div class="acc_font">
                        <label for="text">1. Electrical utility service supplier:</label>
                        <!-- Icon code -->
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
                                    <i class="bi bi-text-paragraph"></i>
                                </span>
                            </div>
                            <textarea class="textarea-size" class="form-control" [readonly]="isEditableEmc"
                                formControlName="powerElectricalUtility" cols="60" rows="1"
                                placeholder="describe type, demand, system earthing, protection at incoming...!"
                                [ngClass]="{'is-invalid':submitted && f.powerElectricalUtility?.errors}"
                                [(ngModel)]="emcPowerAndEarthingData.powerElectricalUtility"></textarea>
                            <div *ngIf="submitted &&f.powerElectricalUtility?.errors" class="invalid-feedback">
                                <div *ngIf="f.powerElectricalUtility?.errors?.required">Field Is Required</div>
                            </div>
                        </div>
                    </div>

                    <!-- Back up source -->
                    <div class="acc_font">
                        <label class="form-label">2. Back up source:</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
                                    <i class="bi bi-text-paragraph"></i>
                                </span>
                            </div>
                            <textarea class="textarea-size" class="form-control" style="font-size: medium;"
                                [(ngModel)]="emcPowerAndEarthingData.powerBackupSource" [readonly]="isEditableEmc"
                                formControlName="powerBackupSource" cols="60" rows="1"
                                [ngClass]="{'is-invalid':submitted && f.powerBackupSource?.errors}"
                                placeholder="describe type, capacity, time delay, loads, etc...!"></textarea>
                            <div *ngIf="submitted &&f.powerBackupSource?.errors" class="invalid-feedback">
                                <div *ngIf="f.powerBackupSource?.errors?.required">Back Up Source Is Required</div>
                            </div>
                        </div>
                    </div>

                    <!-- Distance to HV/LV substation -->
                    <div class="acc_font">
                        <label class="form-label">3. Distance to HV/LV substation:</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
                                    <i class="bi bi-text-paragraph"></i>
                                </span>
                            </div>
                            <textarea class="form-control" formControlName="powerDistanceHvLv" [readonly]="isEditableEmc"
                                [(ngModel)]="emcPowerAndEarthingData.powerDistanceHvLv" cols="60" rows="1"
                                [ngClass]="{'is-invalid':submitted && f.powerDistanceHvLv?.errors}"
                                placeholder="In case transformer with in the premise (HV supply), describe this and the distance to the suppliers substation...!"></textarea>
                            <div *ngIf="submitted &&f.powerDistanceHvLv?.errors" class="invalid-feedback">
                                <div *ngIf="f.powerDistanceHvLv?.errors?.required">Distance to HV/LV Substation Is
                                    Required</div>
                            </div>
                        </div>
                    </div>

                    <!-- Type of incoming cables from HV/LV substation -->
                    <div class="acc_font">
                        <label>4. Type of incoming cables from HV/LV substation:</label>
                        <br>
                        <div class="form-group">
                            <select class="form-control" [(ngModel)]="emcPowerAndEarthingData.powerCableHvLv"
                                formControlName="powerCableHvLv"  [attr.disabled]="isEditableEmc ? '' : null" 
                                [ngClass]="{'is-invalid':submitted && f.powerCableHvLv?.errors}">
                                <option [ngValue]="null">Select Option</option>
                                <option *ngFor="let value of incomingcable">{{value}}</option>
                            </select>
                            <div *ngIf="submitted &&f.powerCableHvLv?.errors" class="invalid-feedback">
                                <div *ngIf="f.powerCableHvLv?.errors?.required">Field Is Required</div>
                            </div>
                        </div>
                    </div>
                    <br>

                    <!-- Description of supply -->
                    <div>
                        <label class="form-label">Description of Supply:</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
                                    <i class="bi bi-text-paragraph"></i>
                                </span>
                            </div>
                            <textarea class="textarea-size" class="form-control" cols="60" rows="1" [readonly]="isEditableEmc"
                                [(ngModel)]="emcPowerAndEarthingData.powerDiscSupply" formControlName="powerDiscSupply"
                                placeholder="Enter Description of supply"
                                [ngClass]="{'is-invalid':submitted && f.powerDiscSupply?.errors}"></textarea>
                            <div *ngIf="submitted &&f.powerDiscSupply?.errors" class="invalid-feedback">
                                <div *ngIf="f.powerDiscSupply?.errors?.required">Description Of Supply Is Required</div>
                            </div>
                        </div>
                    </div>

                    <!-- Transformer characteristics -->
                    <br>
                    <div class="acc_font">
                        <label class="form-label">5. Transformer characteristics:</label>
                        <div>
                            <div>
                                <div>
                                    <label class="form-label">KVA: </label>
                                    <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                        [(ngModel)]="emcPowerAndEarthingData.powerTransformationKVA"
                                        formControlName="powerTransformationKVA"
                                        [ngClass]="{'is-invalid':submitted && f.powerTransformationKVA?.errors}"
                                        placeholder="Enter KVA">
                                    <div *ngIf="submitted &&f.powerTransformationKVA?.errors" class="invalid-feedback">
                                        <div *ngIf="f.powerTransformationKVA?.errors?.required">kVA Is Required</div>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div>
                                <h3 style="font-size: medium;">Input:</h3>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <label class="form-label">Volts:</label>
                                    <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                        [(ngModel)]="emcPowerAndEarthingData.powerInputVolts"
                                        formControlName="powerInputVolts" placeholder="Enter Volts"
                                        [ngClass]="{'is-invalid':submitted && f.powerInputVolts?.errors}">
                                    <div *ngIf="submitted &&f.powerInputVolts?.errors" class="invalid-feedback">
                                        <div *ngIf="f.powerInputVolts?.errors?.required">Volts Is Required</div>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <label class="form-label">No. of Phases:</label>
                                    <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                        [(ngModel)]="emcPowerAndEarthingData.powerInputPhase"
                                        formControlName="powerInputPhase" placeholder="Enter No. of phases"
                                        [ngClass]="{'is-invalid':submitted && f.powerInputPhase?.errors}">
                                    <div *ngIf="submitted &&f.powerInputPhase?.errors" class="invalid-feedback">
                                        <div *ngIf="f.powerInputPhase?.errors?.required">No. Of Phases Is Required</div>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <label class="form-label">No. of    wires:</label>
                                    <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                        [(ngModel)]="emcPowerAndEarthingData.powerInputWires"
                                        formControlName="powerInputWires" placeholder="Enter No. of wires"
                                        [ngClass]="{'is-invalid':submitted && f.powerInputWires?.errors}">
                                    <div *ngIf="submitted &&f.powerInputWires?.errors" class="invalid-feedback">
                                        <div *ngIf="f.powerInputWires?.errors?.required">No. Of wires Is Required</div>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <label class="form-label">Feed (Delta/WYE):</label>
                                    <input type="text" class="form-control" [readonly]="isEditableEmc"
                                        [(ngModel)]="emcPowerAndEarthingData.powerInputFeed"
                                        formControlName="powerInputFeed" placeholder="Enter Feed (Delta/WYE)"
                                        [ngClass]="{'is-invalid':submitted && f.powerInputFeed?.errors}">
                                    <div *ngIf="submitted &&f.powerInputFeed?.errors" class="invalid-feedback">
                                        <div *ngIf="f.powerInputFeed?.errors?.required">Feed (Delta/WYE) Is Required
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="form-label">Describe Other:</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="bi bi-text-paragraph"></i>
                                        </span>
                                    </div>
                                    <textarea class="textarea-size" class="form-control" cols="60" rows="1"
                                        [ngClass]="{'is-invalid':submitted && f.powerInputDesc?.errors}"
                                        formControlName="powerInputDesc" [readonly]="isEditableEmc"
                                        [(ngModel)]="emcPowerAndEarthingData.powerInputDesc"
                                        placeholder="Enter Describe Others"></textarea>
                                    <div *ngIf="submitted &&f.powerInputDesc?.errors" class="invalid-feedback">
                                        <div *ngIf="f.powerInputDesc?.errors?.required">Describe Other Is Required</div>
                                    </div>
                                </div>
                            </div>

                            <br>

                            <!-- Output to MDB -->
                            <div>
                                <h3 class="form-label">Output to MDB:</h3>
                                <div class="row">
                                    <div class="col-md-4">
                                        <label class="form-label">Volts:</label>
                                        <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                            [(ngModel)]="emcPowerAndEarthingData.powerOutputVolts"
                                            formControlName="powerOutputVolts" placeholder="Enter Volts"
                                            [ngClass]="{'is-invalid':submitted && f.powerOutputVolts?.errors}">
                                        <div *ngIf="submitted &&f.powerOutputVolts?.errors" class="invalid-feedback">
                                            <div *ngIf="f.powerOutputVolts?.errors?.required">Output to MDB Is Required
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <label class="form-label">No. of Phases:</label>
                                        <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                            [(ngModel)]="emcPowerAndEarthingData.powerOutputPhase"
                                            formControlName="powerOutputPhase" placeholder="Enter No. of phases"
                                            [ngClass]="{'is-invalid':submitted && f.powerOutputPhase?.errors}">
                                        <div *ngIf="submitted &&f.powerOutputPhase?.errors" class="invalid-feedback">
                                            <div *ngIf="f.powerOutputPhase?.errors?.required">No. Of Phases Is Required
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <label class="form-label">No. of Wires:</label>
                                        <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                            [(ngModel)]="emcPowerAndEarthingData.powerOutputWires"
                                            formControlName="powerOutputWires" placeholder="Enter No. of wires"
                                            [ngClass]="{'is-invalid':submitted && f.powerOutputWires?.errors}">
                                        <div *ngIf="submitted &&f.powerOutputWires?.errors" class="invalid-feedback">
                                            <div *ngIf="f.powerOutputWires?.errors?.required">No. Of Wires Is Required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <label class="form-label">Feed (Delta/WYE):</label>
                                        <input type="text" class="form-control" [readonly]="isEditableEmc"
                                            [(ngModel)]="emcPowerAndEarthingData.powerOutputFeed"
                                            formControlName="powerOutputFeed" placeholder="Enter Feed (Delta/WYE)"
                                            [ngClass]="{'is-invalid':submitted && f.powerOutputFeed?.errors}">
                                        <div *ngIf="submitted &&f.powerOutputFeed?.errors" class="invalid-feedback">
                                            <div *ngIf="f.powerOutputFeed?.errors?.required">Feed (Delta/WYE) Is
                                                Required</div>
                                        </div>
                                    </div>

                                    <!-- Incoming (Amps) -->

                                    <div class="col-md-4">
                                        <label class="form-label">Incoming (Amps):</label>
                                        <input onwheel="this.blur()" class="form-control" [readonly]="isEditableEmc"
                                            [(ngModel)]="emcPowerAndEarthingData.powerIncomingAmps"
                                            formControlName="powerIncomingAmps" placeholder="Enter Amps here"
                                            [ngClass]="{'is-invalid':submitted && f.powerIncomingAmps?.errors}">
                                        <div *ngIf="submitted &&f.powerIncomingAmps?.errors" class="invalid-feedback">
                                            <div *ngIf="f.powerIncomingAmps?.errors?.required">Incoming (Amps) Is
                                                Required</div>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label>Neutral:</label>
                                            <select class="form-control"
                                                [(ngModel)]="emcPowerAndEarthingData.powerNeutral"
                                                formControlName="powerNeutral"[attr.disabled]="isEditableEmc ? '' : null"
                                                [ngClass]="{'is-invalid':submitted && f.powerNeutral?.errors}">
                                                <option [ngValue]="null">Select Option</option>
                                                <option *ngFor="let value of neutral">{{value}}</option>
                                            </select>
                                            <div *ngIf="submitted &&f.powerNeutral?.errors" class="invalid-feedback">
                                                <div *ngIf="f.powerNeutral?.errors?.required">Neutral Is Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <!-- System earthing -->
                            <div>
                                <label class="form-label">System earthing:</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="bi bi-text-paragraph"></i>
                                        </span>
                                    </div>
                                    <textarea class="textarea-size" class="form-control" cols="60" rows="1"
                                        [(ngModel)]="emcPowerAndEarthingData.psEarthing" formControlName="psEarthing"
                                        placeholder="describe how and where?" [readonly]="isEditableEmc"
                                        [ngClass]="{'is-invalid':submitted && f.psEarthing?.errors}"></textarea>
                                    <div *ngIf="submitted &&f.psEarthing?.errors" class="invalid-feedback">
                                        <div *ngIf="f.psEarthing?.errors?.required">System Earthing Is Required</div>
                                    </div>
                                </div>
                            </div>

                            <!-- File Upload -->
                            <table class="table TableBorder" style="margin-top: 3rem;">
                                <thead>
                                    <tr style="text-align: center;">
                                        <th width="25%">Attach SLD of power supply system:</th>
                                        <th width="27%">Name</th>
                                        <th width="6%" ng-show="uploader.isHTML5">Size</th>
                                        <!-- <th ng-show="uploader.isHTML5">Progress</th> -->
                                        <!-- <th>Status</th> -->
                                        <th width="25%">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="item in uploader.queue">
                                        <td>
                                            <input style="height: 3rem;" type="file" id="inputGroupFile01" (change)="onChange($event)" formControlName="peAttachement" 
                                            [(ngModel)]="emcPowerAndEarthingData.peAttachement" 
                                            [ngClass]="{'is-invalid':submitted && f.peAttachement?.errors}" [attr.disabled]="isEditableEmc ? '' : null"
                                            accept=".txt,.jpeg,.png,.jpg,.pdf">
                                            <div *ngIf="submitted &&f.peAttachement?.errors" class="invalid-feedback">
                                                <div *ngIf="f.peAttachement?.errors?.required">Field Is Required</div>
                                            </div>
                                        </td>
                                        <td style="text-align: center;">{{fileName}}</td>
                                        <td ng-show="uploader.isHTML5" nowrap style="text-align: center;">{{fileSize}}</td>

                                        <td nowrap style="text-align: center;">
                                            <button type="button" class="btn btn-secondary btn-xs mr-4" [disabled]="uploadDisable" (click)="onUpload(contentSpinner)" title="Upload">
                                                <i class="fa fa-upload" style="color: white;"></i>
                                            </button>

                                            <button type="button" class="btn btn-success btn-xs mr-4" (click)="onDownload()" *ngIf="fileId != ''" href='javascript:onDownload()' 
                                            href='javascript:void(0)' [ngClass]="{'disableForm':isEditableEmc}" title="Download">
                                                <i class="fa fa-download" style="color: white;"></i>
                                            </button>

                                            <button type="button" class="btn btn-danger btn-xs mr-4" *ngIf="fileId != ''"  (click)="deleteFile(contentSpinnerDelete)" 
                                            [ngClass]="{'disableForm':isEditableEmc}" title="Delete">
                                                <i class="fa fa-trash-o" style="color: white;"></i> Delete
                                            </button>
                                            
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <!-- <br>
                            <div>
                                <label class="form-label">Attach SLD of power supply system:</label>
                                <div class="row input-group mb-2">
                                    <div class="col-md-6">
                                    <input type="file" class="form-control" id="inputGroupFile01" (change)="onChange($event)"
                                        formControlName="peAttachement"  [(ngModel)]="emcPowerAndEarthingData.peAttachement" 
                                        [ngClass]="{'is-invalid':submitted && f.peAttachement?.errors}" [attr.disabled]="isEditableEmc ? '' : null" 
                                        accept=".txt,.jpeg,.png,.jpg,.pdf">


                                    <div *ngIf="submitted &&f.peAttachement?.errors" class="invalid-feedback">
                                        <div *ngIf="f.peAttachement?.errors?.required">Field Is Required</div>
                                    </div>
                                    </div>
                                    <div class="col-md-6">
                                      <button type="button" [disabled]="uploadDisable" class="btn btn-success" (click)="onUpload(contentSpinner)">
                                            Upload
                                      </button>
                                      <a (click)="onDownload()" *ngIf="fileName != ''" href='javascript:void(0)' title="Download" style="margin-left: 30px;text-decoration: underline;" [ngClass]="{'disableForm':isEditableEmc}">
                                        {{fileName}}</a>
                                      <mat-icon *ngIf="fileName != ''" class="mousechange" class="dlt" type="button" title="Delete" style="position: absolute;margin-left: 40px; margin-top: 5px;"(click)="deleteFile(contentSpinnerDelete)" [ngClass]="{'disableForm':isEditableEmc}"
                                       >remove_circle_outline</mat-icon>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <mat-icon class="mousechange" class="dlt" type="button" title="Delete" 
                                       (click)="deleteFile(contentSpinnerDelete)"
                                        style="float: right;position: relative;padding: 3px;font-size: 26px;">remove_circle_outline</mat-icon>
                                       
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>

                    <!-- 6.Building Service Entrance -->
                    <div>
                        <label class="form-label">6. Building Service Entrance:</label>
                        <div>
                            <label class="form-label">Dedicated transformer:</label>
                            <select class="form-control" [(ngModel)]="emcPowerAndEarthingData.dedicatedTransfermation"
                                formControlName="dedicatedTransfermation"  [attr.disabled]="isEditableEmc ? '' : null" 
                                [ngClass]="{'is-invalid':submitted && f.dedicatedTransfermation?.errors}">
                                <option [ngValue]="null">Select Option</option>
                                <option *ngFor="let value of selectionValue">{{value}}</option>
                            </select>
                            <div *ngIf="submitted &&f.dedicatedTransfermation?.errors" class="invalid-feedback">
                                <div *ngIf="f.dedicatedTransfermation?.errors?.required">Dedicated Transformer Is
                                    Required</div>
                            </div>
                        </div>
                        <div>
                            <label class="form-label">If no, which are the other buildings / loads
                                connected to the transformer:</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="bi bi-text-paragraph"></i>
                                    </span>
                                </div>
                                <textarea class="textarea-size" class="form-control" cols="60" rows="1"
                                    [(ngModel)]="emcPowerAndEarthingData.dedicatedTransfermationOtherBuilding"
                                    formControlName="dedicatedTransfermationOtherBuilding" [readonly]="isEditableEmc"
                                    [ngClass]="{'is-invalid':submitted && f.dedicatedTransfermationOtherBuilding?.errors}"
                                    placeholder="Enter If no, which are the other buildings / loads connected to the transformer"></textarea>
                                <div *ngIf="submitted &&f.dedicatedTransfermationOtherBuilding?.errors"
                                    class="invalid-feedback">
                                    <div *ngIf="f.dedicatedTransfermationOtherBuilding?.errors?.required">Field Is
                                        Required</div>
                                </div>
                            </div>
                        </div>

                        <!-- Type and routing of incoming cable from transformer -->
                        <div>
                            <label class="form-label">Type and routing of incoming cable from
                                transformer:</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="bi bi-text-paragraph"></i>
                                    </span>
                                </div>
                                <textarea class="textarea-size" class="form-control" cols="60" rows="1"
                                    [(ngModel)]="emcPowerAndEarthingData.typeOFIncoming"
                                    formControlName="typeOFIncoming" [readonly]="isEditableEmc"
                                    [ngClass]="{'is-invalid':submitted && f.typeOFIncoming?.errors}"
                                    placeholder="metallic conduit / non metallic conduit / others...!"></textarea>
                                <div *ngIf="submitted &&f.typeOFIncoming?.errors" class="invalid-feedback">
                                    <div *ngIf="f.typeOFIncoming?.errors?.required">Field Is Required</div>
                                </div>
                            </div>
                        </div>

                        <!-- Description of service entrance earth electrode -->
                        <div>
                            <label class="form-label">Description of service entrance earth electrode:</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="bi bi-text-paragraph"></i>
                                    </span>
                                </div>
                                <textarea class="textarea-size" class="form-control" cols="60" rows="1"
                                    [(ngModel)]="emcPowerAndEarthingData.descOfService" formControlName="descOfService"
                                    [ngClass]="{'is-invalid':submitted && f.descOfService?.errors}" [readonly]="isEditableEmc"
                                    placeholder="foundation earth / building steel / ring earth / rod / multiple rods / grid / earth plate / burried conduit / metal water pipe etc...!"></textarea>
                                <div *ngIf="submitted &&f.descOfService?.errors" class="invalid-feedback">
                                    <div *ngIf="f.descOfService?.errors?.required">Field Is Required</div>
                                </div>
                            </div>
                        </div>

                        <!-- Describe about testing of service entrance earth electrode -->
                        <div>
                            <label class="form-label">Describe about testing of service entrance earth
                                electrode:</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="bi bi-text-paragraph"></i>
                                    </span>
                                </div>
                                <textarea class="textarea-size" class="form-control" cols="60" rows="1"
                                    [(ngModel)]="emcPowerAndEarthingData.descOfTestingService"
                                    formControlName="descOfTestingService" [readonly]="isEditableEmc"
                                    [ngClass]="{'is-invalid':submitted && f.descOfTestingService?.errors}"
                                    placeholder="Date of testing / Name of person who did the testing / value (impedance in ohms)...!"></textarea>
                                <div *ngIf="submitted &&f.descOfTestingService?.errors" class="invalid-feedback">
                                    <div *ngIf="f.descOfTestingService?.errors?.required">Field Is Required</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 7. Describe about equipotential bonding and SPD's at service entrance -->
                    <div>
                        <div>
                            <label class="form-label">7. Describe about equipotential bonding and SPD's at
                                service entrance:</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="bi bi-text-paragraph"></i>
                                    </span>
                                </div>
                                <textarea class="textarea-size" class="form-control" cols="60" rows="1"
                                    [(ngModel)]="emcPowerAndEarthingData.descOfEquipotentilaBonding"
                                    formControlName="descOfEquipotentilaBonding" [readonly]="isEditableEmc"
                                    [ngClass]="{'is-invalid':submitted && f.descOfEquipotentilaBonding?.errors}"
                                    placeholder="Ex...yes/no. If yes, type and rating of SPD's...!"></textarea>
                                <div *ngIf="submitted &&f.descOfEquipotentilaBonding?.errors" class="invalid-feedback">
                                    <div *ngIf="f.descOfEquipotentilaBonding?.errors?.required">Field Is Required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-expansion-panel>

                <div formArrayName="electronicSystemArr" *ngFor="let a of getElectronicSystemControl(); let i = index">
                    <div [formGroupName]="i">
                        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    <h3>Building Distribution</h3>
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <!-- SLD -->
                            <div>
                                <div>
                                    <label class="form-label">1. SLD:</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="bi bi-text-paragraph"></i>
                                            </span>
                                        </div>
                                        <textarea class="textarea-size" class="form-control" formControlName="bDSld" [readonly]="isEditableEmc"
                                            [ngClass]="{'is-invalid':submitted && a.get('bDSld')?.errors}" cols="60" rows="1"
                                            placeholder="Ex. An one-line diagram of the site power distribution system from the service entrance to the electronic system power distribution panel(s). Show all transformers, load centres, power conditioning equipment, emergency load transfer switches, etc. Also indicate nominal voltage, kVA, type of feed, how run, number of conductors, and approximate length of feeders involved...!"></textarea>
                                        <div *ngIf="submitted &&a.get('bDSld')?.errors" class="invalid-feedback">
                                            <div *ngIf="a.get('bDSld')?.errors?.required">SLD Is Required</div>
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <!-- Notes -->
                                <div>
                                    <label for="" style="font-weight: bold;">Note: any heavy cycling loads or variable
                                        load
                                        controllers fed from the same distribution feeder path that supplies the
                                        computer
                                        system.</label>
                                </div>

                                <div>
                                    <label for="" style="font-weight: bold;">Note: how protective earthing distribution
                                        is
                                        accomplished (conduit only, flexible conduit and bond wire, other).</label>
                                </div>

                                <!-- Record data -->
                                <div>
                                    <label class="form-label">2. Record data:</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="bi bi-text-paragraph"></i>
                                            </span>
                                        </div>
                                        <textarea class="textarea-size" class="form-control"
                                            formControlName="bDRecordData" cols="60" rows="1" [readonly]="isEditableEmc"
                                            [ngClass]="{'is-invalid':submitted && a.get('bDRecordData')?.errors}"
                                            placeholder="Ex. Record data (including name-plate data) note any power conditioning equipment and/or last transformer before electronic system load...!"></textarea>
                                        <div *ngIf="submitted &&a.get('bDRecordData')?.errors" class="invalid-feedback">
                                            <div *ngIf="a.get('bDRecordData')?.errors?.required">Record Data Is Required
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Earthing  -->
                                <div>
                                    <label class="form-label">3. Earthing :</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="bi bi-text-paragraph"></i>
                                            </span>
                                        </div>
                                        <textarea class="textarea-size" class="form-control"
                                            formControlName="bDEarthing" cols="60" rows="1" [readonly]="isEditableEmc"
                                            [ngClass]="{'is-invalid':submitted && a.get('bDEarthing')?.errors}"
                                            placeholder="Ex. Describe how and where earthing of power conditioning equipment carried out...!"></textarea>
                                        <div *ngIf="submitted &&a.get('bDEarthing')?.errors" class="invalid-feedback">
                                            <div *ngIf="a.get('bDEarthing')?.errors?.required">Earthing Is Required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </mat-expansion-panel>

                        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    <h3>Electronics System Room Power Distribution</h3>
                                </mat-panel-title>
                                
                            </mat-expansion-panel-header>

                            <!--1. Using the SLD, sketch the system power and ground distribution system, including all major components in (or immediately adjacent to) the computer room. Clearly identify all major components -->

                            <!-- Electronic system power distribution panel -->
                            <div>
                                <div>
                                    <label class="form-label">1. Description:</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="bi bi-text-paragraph"></i>
                                            </span>
                                        </div>
                                        <textarea class="textarea-size" class="form-control"
                                            formControlName="electronicDesc" cols="60" rows="1" [readonly]="isEditableEmc"
                                            [ngClass]="{'is-invalid':submitted && a.get('electronicDesc')?.errors}"
                                            placeholder="Ex. Using the SLD, sketch the system power and ground distribution system, including all major components in (or immediately adjacent to) the computer room. Clearly identify all major components...!"></textarea>
                                        <div *ngIf="submitted &&a.get('electronicDesc')?.errors"
                                            class="invalid-feedback">
                                            <div *ngIf="a.get('electronicDesc')?.errors?.required">Description Is
                                                Required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <label class="form-label">2. Electronic system power distribution panel:</label>

                                <div class="container-fluid">
                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">
                                        <tr>
                                            <td rowspan="1" style="width: 4rem;">a.</td>
                                            <td style="width: 27rem;">
                                                <label class="form-label">Panel ID:</label>
                                            </td>

                                            <td>
                                                <input onwheel="this.blur()" class="form-control" formControlName="panelId"
                                                    [ngClass]="{'is-invalid':submitted && a.get('panelId')?.errors}" [readonly]="isEditableEmc"
                                                    placeholder="Enter ID here">
                                                <div *ngIf="submitted &&a.get('panelId')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('panelId')?.errors?.required">Field Is Required
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">

                                        <tr>
                                            <td rowspan="1" style="width: 4rem;">
                                                <label class="form-label">b.</label>
                                            </td>
                                            <td style="width: 27rem;">
                                                <label class="form-label">Name plate data (manufacturer):</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="namePlateData"
                                                    placeholder="Name (manufacturer)" [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('namePlateData')?.errors}">
                                                <div *ngIf="submitted &&a.get('namePlateData')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('namePlateData')?.errors?.required">Name Plate
                                                        Data Is
                                                        Required</div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">
                                        <tr>
                                            <td rowspan="3" style="width: 4rem;">
                                                <label class="form-label">c.</label>
                                            </td>
                                            <td style="width: 27rem;">
                                                <label class="form-label">Main circuit breaker:</label>
                                            </td>
                                            <td style="width: 36rem;">
                                                <select class="form-control" formControlName="mainCircuteBraker"   [attr.disabled]="isEditableEmc ? '' : null" 
                                                    [ngClass]="{'is-invalid':submitted && a.get('mainCircuteBraker')?.errors}">
                                                    <!-- <option value="o">choose yes/no</option> -->
                                                    <option [ngValue]="null">Select Option</option>
                                                    <option *ngFor="let value of selectionValue">{{value}}</option>
                                                </select>
                                                <div *ngIf="submitted &&a.get('mainCircuteBraker')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('mainCircuteBraker')?.errors?.required">Main
                                                        Circuit Breaker Is
                                                        Required</div>
                                                </div>
                                            </td>
                                            <td>
                                                <p style="font-size: 100%;">Rating (A)
                                                    <input type="text" style=" 
                            width: 50px;
                            background: transparent;
                            border: none;
                            border-bottom: 1px solid #000000;" formControlName="mainCircuteBrakerRating"
                                                        style="width:60px"  [attr.disabled]="isEditableEmc ? '' : null" 
                                                        [ngClass]="{'is-invalid':submitted && a.get('mainCircuteBrakerRating')?.errors}">
                                                </p>
                                                <div *ngIf="submitted &&a.get('mainCircuteBrakerRating')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('mainCircuteBrakerRating')?.errors?.required">
                                                        Field Is Required</div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td rowspan="1" style="font-size: 100%;">Emergency trip?</td>
                                            <td>
                                                <p style="font-size: 100%;">Remote <input type="text" style=" 
                                width: 50px;
                                background: transparent;
                                border: none;
                                border-bottom: 1px solid #000000;" formControlName="emergencyTripRemote"
                                                        style="width:60px"    [attr.disabled]="isEditableEmc ? '' : null" 
                                                        [ngClass]="{'is-invalid':submitted && a.get('emergencyTripRemote')?.errors}" />
                                                    local<input type="text" style=" 
                                width: 50px;
                                background: transparent;
                                border: none;
                                border-bottom: 1px solid #000000;" formControlName="emergencyTripLocal"
                                                        style="width:60px"   [attr.disabled]="isEditableEmc ? '' : null" 
                                                        [ngClass]="{'is-invalid':submitted && a.get('emergencyTripLocal')?.errors}" />
                                                    none</p>
                                                <div *ngIf="submitted &&a.get('emergencyTripRemote')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('emergencyTripRemote')?.errors?.required">
                                                        Remote Field Is Required</div>
                                                </div>
                                                <div *ngIf="submitted &&a.get('emergencyTripLocal')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('emergencyTripLocal')?.errors?.required">
                                                        Local Field Is Required</div>
                                                </div>
                                            </td>

                                        </tr>
                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">
                                        <tr>
                                            <td rowspan="2" style="width: 4rem;">
                                                <label class="form-label">d.</label>
                                            </td>

                                            <td style="width: 27rem;">
                                                <label class="form-label">Other trips:</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="otherTrip"
                                                    placeholder="Under voltage / over voltage"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('otherTrip')?.errors}">
                                                <div *ngIf="submitted &&a.get('otherTrip')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('otherTrip')?.errors?.required">Other Trips Is
                                                        Required
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td>
                                                <label class="form-label">Differential protection:</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control"
                                                    [ngClass]="{'is-invalid':submitted && a.get('differentalProtection')?.errors}"
                                                    formControlName="differentalProtection"  [readonly]="isEditableEmc"
                                                    placeholder="Enter Differential protection">
                                                <div *ngIf="submitted &&a.get('differentalProtection')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('differentalProtection')?.errors?.required">
                                                        Differential Protection
                                                        Is Required</div>
                                                </div>
                                            </td>
                                        </tr>

                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">

                                        <tr>
                                            <td rowspan="1" style="width: 4rem;">
                                                <label class="form-label">e.</label>
                                            </td>

                                            <td style="width: 27rem;">
                                                <label class="form-label">Panel bonded to building
                                                    steel:</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="bouodingStell" [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('bouodingStell')?.errors}"
                                                    placeholder="YES / NO. Describe bond location - external or internal steel member">
                                                <div *ngIf="submitted &&a.get('bouodingStell')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('bouodingStell')?.errors?.required">Field Is
                                                        Required</div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">
                                        <tr>
                                            <td rowspan="4" style="width: 4rem;">
                                                <label class="form-label">f.</label>
                                            </td>
                                            <td style="width: 27rem;">
                                                <label class="form-label">Panel feed:</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="panelFeed"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('panelFeed')?.errors}"
                                                    placeholder="WYE / DELTA / SPLIT PHASE / Single phase / No of wires">
                                                <div *ngIf="submitted &&a.get('panelFeed')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('panelFeed')?.errors?.required">Panel Feed Is
                                                        Required
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <label class="form-label">Phase wires:</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="phaseWires"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('phaseWires')?.errors}"
                                                    placeholder="Cu / Al, Size, Number and insulation type">
                                                <div *ngIf="submitted &&a.get('phaseWires')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('phaseWires')?.errors?.required">Phase Wires Is
                                                        Required
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <label class="form-label">Neutral wire:</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="neutralWire"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('neutralWire')?.errors}"
                                                    placeholder="Cu / Al, Size, Number and insulation type">
                                                <div *ngIf="submitted &&a.get('neutralWire')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('neutralWire')?.errors?.required">Neutral Wire Is
                                                        Required</div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <label class="form-label">PE wire size:</label>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="peWireSize"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('peWireSize')?.errors}"
                                                    placeholder="Cu / Al, Size, Number and insulation type">
                                                <div *ngIf="submitted &&a.get('peWireSize')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('peWireSize')?.errors?.required">PE Wire Size Is
                                                        Required
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">
                                        <tr>
                                            <td rowspan="4" style="width: 4rem;">g.</td>
                                            <td rowspan="4" style="width: 27rem; font-size: 100%;">Panel connectors</td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <input type="text" class="form-control"
                                                    [ngClass]="{'is-invalid':submitted && a.get('pannelConnectors')?.errors}"
                                                    formControlName="pannelConnectors"  [readonly]="isEditableEmc"
                                                    placeholder="Type - Cu / Al, Cu/Al">
                                                <div *ngIf="submitted &&a.get('pannelConnectors')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('pannelConnectors')?.errors?.required">Panel
                                                        Connectors Is
                                                        Required</div>
                                                </div>
                                            </td>
                                        </tr>
                                        <!--  <tr>
                                            <td>
                                                <input type="text" class="form-control" formControlName=""
                                                    placeholder="Any discoloration / corrosion">
                                            </td>
                                        </tr> -->
                                        <!-- <tr>
                                            <td>
                                                <input type="text" class="form-control" formControlName=""
                                                    placeholder="Termination quality (checked / not checked??)">
                                            </td>
                                        </tr> -->
                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">
                                        <tr>
                                            <td rowspan="4" style="width: 4rem;">h.</td>
                                            <td rowspan="4" style="width: 27rem; font-size: 100%;">Neutral and earth
                                                busbars
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-size: 100%; width: 25rem;">Neutral bus:</td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="neutralBus"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('neutralBus')?.errors}"
                                                    placeholder="insulated from panel?? (check for bonding screws / straps) etc">
                                                <div *ngIf="submitted &&a.get('neutralBus')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('neutralBus')?.errors?.required">Neutral Bus Is
                                                        Required
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-size: 100%;">Earth bus:</td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="earthBus"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('earthBus')?.errors}"
                                                    placeholder="(available  / not available) (insulated / uninsulated) quality of bonding">
                                                <div *ngIf="submitted &&a.get('earthBus')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('earthBus')?.errors?.required">Earth Bus Is
                                                        Required
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-size: 100%;">List of non electronic loads on earth bus:</td>
                                            <td>
                                                <input type="text" class="form-control"
                                                    [ngClass]="{'is-invalid':submitted && a.get('listOfNonElectronicLoad')?.errors}"
                                                    formControlName="listOfNonElectronicLoad"  [readonly]="isEditableEmc"
                                                    placeholder="List of non electronic loads on earth bus">
                                                <div *ngIf="submitted &&a.get('listOfNonElectronicLoad')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('listOfNonElectronicLoad')?.errors?.required">
                                                        Field Is Required</div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>

                                    <table cellpadding="7" cellspacing="7" border="1"
                                        style="border:solid 1px #ddd;font-size:14px; line-height:24px; width:100%; border-collapse:collapse; margin:15px 0 0 0px;">
                                        <tr>
                                            <td rowspan="3" style="width: 4rem;">i.</td>
                                            <td rowspan="3" style="width: 27rem; font-size: 100%;">Uses</td>
                                        </tr>
                                        <tr>
                                            <td style="font-size: 100%; width: 25rem;">Dedicated to electronic system?:
                                            </td>
                                            <td>
                                                <input type="text" class="form-control"  [readonly]="isEditableEmc"
                                                    formControlName="dedicatedElectronicSystem"
                                                    [ngClass]="{'is-invalid':submitted && a.get('dedicatedElectronicSystem')?.errors}"
                                                    placeholder="Enter Dedicated to electronic system?">
                                                <div *ngIf="submitted &&a.get('dedicatedElectronicSystem')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('dedicatedElectronicSystem')?.errors?.required">
                                                        Dedicated to Electronic System Is Required</div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-size: 100%;">List all non computer loads, including any
                                                convenience
                                                receptacles:</td>
                                            <td>
                                                <input type="text" class="form-control"  [readonly]="isEditableEmc"
                                                    [ngClass]="{'is-invalid':submitted && a.get('nonComputerLoads')?.errors}"
                                                    formControlName="nonComputerLoads" placeholder="Enter List all non computer loads, including any
                                        convenience receptacles">
                                                <div *ngIf="submitted &&a.get('nonComputerLoads')?.errors"
                                                    class="invalid-feedback">
                                                    <div *ngIf="a.get('nonComputerLoads')?.errors?.required">Field Is
                                                        Required</div>
                                                </div>
                                            </td>
                                        </tr>

                                    </table>
                                </div>
                            </div>
                        </mat-expansion-panel>
                    </div>
                </div>

                <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                    <!-- Distribution panel at load (final circuits) -->
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <h3>Distribution panel At Load (Final Circuits)</h3>
                        </mat-panel-title>
                        
                    </mat-expansion-panel-header>

                    <div formArrayName="distributionPannelArr"
                        *ngFor="let b of getDistributionPannelControl(); let j = index">
                        <div class="form-group" [formGroupName]="j">

                            <!-- a. Branch circuit wire size -->
                            <div>
                                <label class="form-label">a. Branch circuit wire size:</label>
                                <br>
                                <label class="form-label">Wire size compatilble to circuit braker:</label>
                                <select class="form-control" formControlName="cbWireSize"  [attr.disabled]="isEditableEmc ? '' : null" 
                                    [ngClass]="{'is-invalid':submitted && b.get('nonComputerLoads')?.errors}">
                                    <option [ngValue]="null">Select Option</option>
                                    <option *ngFor="let value of selectionValue">{{value}}</option>
                                </select>
                                <div *ngIf="submitted &&b.get('cbWireSize')?.errors" class="invalid-feedback">
                                    <div *ngIf="b.get('cbWireSize')?.errors?.required">Branch Circuit Wire Size Is
                                        Required</div>
                                </div>
                                <div>
                                    <label class="form-label">Description:</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="bi bi-text-paragraph"></i>
                                            </span>
                                        </div>
                                        <textarea class="textarea-size" class="form-control" formControlName="cbDesc" [readonly]="isEditableEmc"
                                            [ngClass]="{'is-invalid':submitted && b.get('cbDesc')?.errors}" cols="60" rows="1"
                                            placeholder="Description"></textarea>
                                        <div *ngIf="submitted &&b.get('cbDesc')?.errors" class="invalid-feedback">
                                            <div *ngIf="b.get('cbDesc')?.errors?.required">Description Is Required</div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <label class="form-label">Matches receptable:</label>
                                    <select name="" id="" class="form-control" formControlName="matchesReceptable"
                                    [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('matchesReceptable')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('matchesReceptable')?.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="b.get('matchesReceptable')?.errors?.required">Matches Receptable Is
                                            Required
                                        </div>
                                    </div>
                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control" [readonly]="isEditableEmc"
                                                formControlName="matchesReceptableDesc" cols="60" rows="1"
                                                [ngClass]="{'is-invalid':submitted && b.get('matchesReceptableDesc')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('matchesReceptableDesc')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('matchesReceptableDesc')?.errors?.required">
                                                    Description Is
                                                    Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--b. Individual insulated PE wire run in each electronics load circuit -->
                            <div>
                                <div>
                                    <label class="form-label">b. Individual insulated PE wire run in each
                                        electronics load circuit:</label>
                                    <select name="" id="" class="form-control" formControlName="indivdialPwire"
                                    [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('indivdialPwire')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('indivdialPwire')?.errors" class="invalid-feedback">
                                        <div *ngIf="b.get('indivdialPwire')?.errors?.required">Field Is Required</div>
                                    </div>
                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control" [readonly]="isEditableEmc"
                                                formControlName="indivdialPwireDesc" cols="60" rows="1"
                                                [ngClass]="{'is-invalid':submitted && b.get('indivdialPwireDesc')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('indivdialPwireDesc')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('indivdialPwireDesc')?.errors?.required">Description
                                                    Is
                                                    Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--c. Individual insulated neutral wire run in each computer load circuit (if necessary??) -->
                            <div>
                                <div>
                                    <label class="form-label">c. Individual insulated neutral wire run in each
                                        computer load circuit (if necessary??</label>
                                    <select name="" id="" class="form-control" formControlName="indivdialNeutralwire"
                                    [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('indivdialNeutralwire')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('indivdialNeutralwire')?.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="b.get('indivdialNeutralwire')?.errors?.required">Field Is Required
                                        </div>
                                    </div>
                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control" [readonly]="isEditableEmc"
                                                formControlName="indivdialNeutralwireDesc" cols="60" rows="1"
                                                [ngClass]="{'is-invalid':submitted && b.get('indivdialNeutralwireDesc')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('indivdialNeutralwireDesc')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('indivdialNeutralwireDesc')?.errors?.required">
                                                    Description
                                                    Is Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- d. All computer load circuits correctly identified -->
                            <div>
                                <div>
                                    <label class="form-label">d. All computer load circuits correctly
                                        identified:</label>
                                    <select name="" id="" class="form-control" formControlName="computerLoadCircute"
                                    [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('computerLoadCircute')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('computerLoadCircute')?.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="b.get('computerLoadCircute')?.errors?.required">Field Is Required
                                        </div>
                                    </div>
                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control"
                                                formControlName="computerLoadCircuteDes" cols="60" rows="1" [readonly]="isEditableEmc"
                                                [ngClass]="{'is-invalid':submitted && b.get('computerLoadCircuteDes')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('computerLoadCircuteDes')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('computerLoadCircuteDes')?.errors?.required">
                                                    Description Is
                                                    Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- e. All computer load circuits (<30 A/phase) terminated in isolated earth receptacles -->
                            <div>
                                <div>
                                    <label class="form-label">e. All computer load circuits (30/Aphase)
                                        terminated in isolated earth receptacles:</label>
                                    <select name="" id="" class="form-control" formControlName="computerLoadReceptable"  [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('computerLoadReceptable')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('computerLoadReceptable')?.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="b.get('computerLoadReceptable')?.errors?.required">Field Is Required
                                        </div>
                                    </div>
                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control"
                                                formControlName="computerLoadReceptableDesc" cols="60" rows="1"  [readonly]="isEditableEmc"
                                                [ngClass]="{'is-invalid':submitted && b.get('computerLoadReceptableDesc')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('computerLoadReceptableDesc')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('computerLoadReceptableDesc')?.errors?.required">
                                                    Description
                                                    Is Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- f. System branch circuits run in (metallic conduits / non metallic conduits) -->
                            <div>
                                <div>
                                    <label class="form-label">f. System branch circuits run in (metallic
                                        conduits / non metallic conduits):</label>
                                    <select name="" id="" class="form-control" formControlName="branchCircuteRun"  [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('branchCircuteRun')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('branchCircuteRun')?.errors" class="invalid-feedback">
                                        <div *ngIf="b.get('branchCircuteRun')?.errors?.required">Field Is Required</div>
                                    </div>

                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control" [readonly]="isEditableEmc"
                                                formControlName="branchCircuteRunDesc" cols="60" rows="1"
                                                [ngClass]="{'is-invalid':submitted && b.get('branchCircuteRunDesc')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('branchCircuteRunDesc')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('branchCircuteRunDesc')?.errors?.required">Description
                                                    Is
                                                    Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--g. Frequently cyclid loads (disks/tapes etc) power circuit run seperately or in same physical closure -->
                            <div>
                                <div>
                                    <label class="form-label">g. Frequently cyclid loads (disks/tapes etc) power
                                        circuit run seperately or in same physical closure:</label>
                                    <select name="" id="" class="form-control" formControlName="frequencyCyclidLoads"  [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('frequencyCyclidLoads')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('frequencyCyclidLoads')?.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="b.get('frequencyCyclidLoads')?.errors?.required">Field Is Required
                                        </div>
                                    </div>
                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control" [readonly]="isEditableEmc"
                                                formControlName="frequencyCyclidLoadsDesc" cols="60" rows="1"
                                                [ngClass]="{'is-invalid':submitted && b.get('frequencyCyclidLoadsDesc')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('frequencyCyclidLoadsDesc')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('frequencyCyclidLoadsDesc')?.errors?.required">
                                                    Description
                                                    Is Required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- h. Any phase conductor, neutral conductor or PE condcutors daisy chained?? -->
                            <div>
                                <div>
                                    <label class="form-label">h. Any phase conductor, neutral conductor or PE
                                        condcutors daisy chained??</label>
                                    <select name="" id="" class="form-control" formControlName="conductors"  [attr.disabled]="isEditableEmc ? '' : null" 
                                        [ngClass]="{'is-invalid':submitted && b.get('conductors')?.errors}">
                                        <option [ngValue]="null">Select Option</option>
                                        <option *ngFor="let value of selectionValue">{{value}}</option>
                                    </select>
                                    <div *ngIf="submitted &&b.get('conductors')?.errors" class="invalid-feedback">
                                        <div *ngIf="b.get('conductors')?.errors?.required">Field Is Required</div>
                                    </div>
                                    <div>
                                        <label class="form-label">Description:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="bi bi-text-paragraph"></i>
                                                </span>
                                            </div>
                                            <textarea class="textarea-size" class="form-control" [readonly]="isEditableEmc"
                                                formControlName="conductorsDesc" cols="60" rows="1"
                                                [ngClass]="{'is-invalid':submitted && b.get('conductorsDesc')?.errors}"
                                                placeholder="Description"></textarea>
                                            <div *ngIf="submitted &&b.get('conductorsDesc')?.errors"
                                                class="invalid-feedback">
                                                <div *ngIf="b.get('conductorsDesc')?.errors?.required">Description Is
                                                    Required
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-expansion-panel>

            </mat-accordion>

            <div *ngIf="validationError" style="text-align: center;margin-top: 30px;">
                <span class="alert alert-danger">{{validationErrorMsg}}</span>
            </div>

            <div style="text-align: center;margin-top: 40px;margin-bottom: 20px;">
                <!-- <button class="previous" mat-button matStepperPrevious>&laquo; Back</button> -->
                <button type="submit" class="next" (click)="gotoNextModal(content2, content)" mat-button>Next &raquo;</button>
            </div>
        </form>
    </div>


    <ng-template #content2 let-modal>
        <!-- Spinner -->
        <mat-progress-spinner style="margin: 0 auto;" *ngIf="spinner" color="primary" [mode]="mode" value="50" diameter="50">
        </mat-progress-spinner>
        <br>
        <div *ngIf="spinner" style="text-align: center;">
            Please wait, the details are loading!
        </div>

        <div class="modal-body" *ngIf="popup">
            <div class="centre-text m-btm30">
                <div *ngIf="success" style="text-align: center;">
                    <span class="successshow">{{successMsg}}</span>
                </div>
                <div *ngIf="Error" style="text-align: center;">
                    <span class="errorshow">{{errorMsg}}</span>
                </div>
            </div>
        </div>
        <br>
        <div *ngIf="popup">
            <button type="button" class="close" style="text-align: center;margin-left:180px;width:20%"
                class="btn btn-block btn-primary btn-rounded btn-md font-weight-medium auth-form-btn" aria-label="Close"
                (click)="closeModalDialog()" matStepperNext>
                <span aria-hidden="true">Ok</span>
            </button>
        </div>
    </ng-template>

    <ng-template #content let-modal>
        <div class="modal-body">
            <div class="centre-text m-btm30">
                <div style="text-align: center;">
                    <span class="successshow">Are you sure you want to procced? </span>
                    <br>
                    <span style="font-size: 12px;">Note: Please verify all the details! </span>
                </div>
            </div>
        </div>
        <br>
        <div class="row">
            <button type="button" class="col-md-4" style="text-align: center;margin-left:100px;width:20%"
                class="btn btn-primary btn-rounded btn-md font-weight-medium auth-form-btn" aria-label="Close"
                (click)="closeModalDialog()" matStepperNext>
                <i class="bi bi-arrow-right-circle"></i>&nbsp;
                <span aria-hidden="true">Ok</span>
            </button>
            <button type="button" class="col-md-4" style="text-align: center;margin-left:100px;width:20%"
                class="btn btn-danger btn-rounded btn-md font-weight-medium auth-form-btn" aria-label="Close"
                (click)="closeModalDialog()">
                <i class="bi bi-x icon"></i>
                <span aria-hidden="true">Cancel</span>
            </button>
        </div>
    </ng-template>

    <ng-template #contentSpinner let-modal>
        <mat-progress-spinner style="margin: 0 auto;" *ngIf="spinnerUpload" color="primary" [mode]="mode" value="50" diameter="50">
        </mat-progress-spinner>
        <div *ngIf="spinnerUpload" style="text-align: center;">
            Please wait, the details are loading!
        </div>
        <div class="modal-body" *ngIf="popupUpload">
            <div class="centre-text m-btm30">
                <div *ngIf="filesuccess" style="text-align: center;">
                    <span class="successshow">{{filesuccessMsg}}</span>
                </div>
                <div *ngIf="Error" style="text-align: center;">
                    <span class="errorshow">{{errorMsg}}</span>
                </div>
            </div>
        </div>
        <br>
        <div *ngIf="popupUpload">
            <button type="button" style="text-align: center;margin-left:180px;width:20%" class="close"
                class="btn btn-block btn-primary btn-rounded btn-md font-weight-medium auth-form-btn" aria-label="Close">
                <span (click)="closeModalDialogFile()">Ok</span>
            </button>
        </div>
    </ng-template>

    <ng-template #contentSpinnerDelete let-modal>
        <mat-progress-spinner style="margin: 0 auto;" *ngIf="finalSpinnerDelete" color="primary"
        [mode]="mode"
        value="50"
       diameter="50">
       <div *ngIf="finalSpinnerDelete" style="text-align: center;">
        Please wait, the details are loading!
        </div>
        </mat-progress-spinner>
        <div class="modal-body" *ngIf="popupDelete">
            <div class="centre-text m-btm30">
                <div *ngIf="fileDeleteSuccess" style="text-align: center;">
                    <span class="successshow">{{fileDeletesuccessMsg}}</span>
                </div>
                <div *ngIf="Error" style="text-align: center;">
                    <span class="errorshow">{{errorMsg}}</span>
                </div>
            </div>
        </div>
        <br>
        <div *ngIf="popupDelete">
            <button type="button" style="text-align: center;margin-left:180px;width:20%" class="close"
                class="btn btn-block btn-primary btn-rounded btn-md font-weight-medium auth-form-btn" aria-label="Close">
                <span (click)="closeModalDialogFile()">Ok</span>
            </button>
        </div>
    </ng-template>
    
    

    