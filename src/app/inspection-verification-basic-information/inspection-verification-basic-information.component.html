<div *ngIf="service.msgForStep1" style="text-align: center;margin-top: 30px;">
  <span class="successshow">Please fill step1 to proceed further!</span>
</div>
<div *ngIf="tabError" style="text-align: center;">
  <span class="alert alert-danger">{{tabErrorMsg}}</span>
</div>
<div *ngIf="validationErrorTab" style="text-align: center;">
  <span class="alert alert-danger">{{validationErrorMsgTab}}</span>
</div>
<div class="card">
    <div class="card-body">
      <form [formGroup]="step1Form" (ngSubmit)="nextTab(flag)" (keyup)="onKeyForm($event)" (change)="onChangeForm($event)" 
      (window:beforeunload)="doBeforeUnload()"
      (window:popstate)="onPopState($event)">
      <div class="search-bar">
        <div class="form-group" *ngIf="siteDetails">
          <div class="row">
            <!-- <div class="col-md-4">
                  <label>Company Name*</label>
                  <input type="text" class="form-control" formControlName="clientName" [(ngModel)]="companyNameSite" readonly/>
            </div>
            <div class="col-md-4">
                  <label>Department Name*</label>
                  <input type="text" class="form-control"  formControlName="departmentName" [(ngModel)]="departmentNameSite" readonly/>
            </div> -->
            <div class="col-md-6">
                  <label>Site Name</label>
                  <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 80%;"
                  matTooltip="Respective site / end customer / user (client and site name can be same)."
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
          </mat-icon>
                  <input type="text" class="form-control"  formControlName="siteName" [(ngModel)]="siteValue" readonly/>
            </div>
          </div>
      </div>
        <div class="form-group" *ngIf="siteDetails1">
          <div class="row">
            <!-- <div class="col-md-4">
                  <label>Company Name</label>
                  <input type="text" class="form-control" formControlName="clientName1" readonly/>
            </div>
            <div class="col-md-4">
                  <label>Department Name</label>
                  <input type="text" class="form-control"  formControlName="departmentName1" readonly/>
            </div> -->
            <div class="col-md-6">
                  <label>Site Name</label>
                  <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 80%;"
                  matTooltip="Respective site / end customer / user (client and site name can be same)."
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
          </mat-icon>
                  <input type="text" class="form-control"  formControlName="site1" readonly/>
            </div>
          </div>
      </div>
      </div>
      <!-- (click)="clickAcc();" -->
      <mat-accordion>
          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Details Of Report</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="row" >
              <div class="col-md-4">
                <mat-form-field class="client-description">
                  <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 76%;"
                  matTooltip="Electrical safety audit / Periodic safety audit / root cause analysis after an accident or failure."
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
                 </mat-icon>
                  <mat-label>
                    <h3>Description of Report
                  </h3>
                  </mat-label>
                  <textarea matInput class="client-box-description" formControlName="descriptionOfReport" [ngClass]="{'disableForm':service.allFieldsDisable}"
                  maxlength="500" placeholder="Ex. Report description..." [(ngModel)]="reportDetails.descriptionReport"
                  [ngClass]="{ 'is-invalid': submitted && f.descriptionOfReport.errors }" [readonly]="service.allFieldsDisable"></textarea>
                  <div *ngIf="submitted && f.descriptionOfReport.errors" class="invalid-feedback">
                    <div *ngIf="f.descriptionOfReport?.errors?.required">Description is required</div>
                </div>
                </mat-form-field>
              </div>
            </div>
              <div class="row">
              <div class="col-md-4">
                <mat-form-field class="client-description">
                  <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 76%;"
                  matTooltip="General inspection/ periodic inspection/ incident (in detail)/ proposal for renovation or alteration or addition."
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
                 </mat-icon>
                  <mat-label><h3>Reason for the Report</h3></mat-label>
                  <textarea matInput class="client-box-description" formControlName="reasonOfReport" [ngClass]="{'disableForm':service.allFieldsDisable}"
                  maxlength="500" placeholder="Ex. Report reason..." [(ngModel)]="reportDetails.reasonOfReport" 
                  [ngClass]="{ 'is-invalid': submitted && f.reasonOfReport.errors }" [readonly]="service.allFieldsDisable"></textarea>
                  <div *ngIf="submitted && f.reasonOfReport.errors" class="invalid-feedback">
                    <div *ngIf="f.reasonOfReport?.errors?.required">Reason is required</div>
                </div>
                </mat-form-field>
              </div>
            </div> 
          </mat-expansion-panel>
          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Installation Details</h3>
              </mat-panel-title>

            </mat-expansion-panel-header>
            <div class="row" >
              <div class="col-md-4" [ngClass]="{'disableForm':service.allFieldsDisable}">
                <div class="form-group">
                  <label>Type of Installation* :</label>
                  <select class="form-control" formControlName="installationType" (change)="showWiringAge($event)" 
                  [tabindex]="service.allFieldsDisable ? -1 : 0" 
                  [disabled]="service.allFieldsDisable"
                  [(ngModel)]="reportDetails.installationType" [ngClass]="{ 'is-invalid': submitted && f.installationType.errors }">
                    <option value="" selected>Select Option</option>
                    <option *ngFor="let value of installationList">{{value}}</option>
                    <!-- <option value="New Installation" [selected]="f.installationType?.value === 'New Installation'"
                   >New Installation</option>
                    <option value="First Verification Of An Existing Installation" [selected]="f.installationType?.value === 'First Verification Of An Existing Installation'"
                    >First Verification Of An Existing Installation</option>
                    <option value="Addition Of An Existing Installation" [selected]="f.installationType?.value === 'Addition Of An Existing Installation'"
                    >Addition Of An Existing Installation</option>
                    <option value="Alteration In An Existing Installation" [selected]="f.installationType?.value === 'Alteration In An Existing Installation'"
                    >Alteration In An Existing Installation</option>
                    <option value="Periodic Verification" [selected]="f.installationType?.value === 'Periodic Verification'"
                    >Periodic Verification</option> -->
                  </select>
                  <div *ngIf="submitted && f.installationType.errors" class="invalid-feedback">
                    <div *ngIf="f.installationType?.errors?.required">Installation type is required</div>
                </div>
                </div>
              </div>


              <div class="col-md-4">
                <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 45%;"
                  matTooltip="Type of premise"
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
                 </mat-icon>
                <div class="form-group" [ngClass]="{'disableForm':service.allFieldsDisable}">
                  
                  <label>Description of the Premise* :</label>
                  
                  <select class="form-control" formControlName="descPremise" [disabled]="service.allFieldsDisable" [tabindex]="service.allFieldsDisable ? -1 : 0"
                  [(ngModel)]="reportDetails.descriptionPremise" [ngClass]="{ 'is-invalid': submitted && f.descPremise.errors }">
                   <option value="" selected>Select Option</option>
                    <option *ngFor="let value of premiseList" >{{value}}</option>
                  </select>
                  <div *ngIf="submitted && f.descPremise.errors" class="invalid-feedback">
                    <div *ngIf="f.descPremise?.errors?.required">Field Is Required</div>
                </div>
                </div>
              </div>

              <div class="col-md-4" [ngClass]="{'disableForm':service.allFieldsDisable}" *ngIf="showField1" style="margin-top: 24px;">
                  <label>Estimated Age of Wiring System Years:</label>
                    <input type="tel" formControlName="showField1" [readonly]="service.allFieldsDisable" style="
                    width: 50px;
                    background: transparent;
                    border: none;
                    border-bottom: 1px solid #000000;"
                     [(ngModel)]="reportDetails.estimatedWireAge"
                     [ngClass]="{ 'is-invalid': submitted && f.showField1.errors }">
                     <div *ngIf="submitted && f.showField1.errors" class="invalid-feedback">
                      <div *ngIf="f.showField1?.errors?.required">Field Is Required</div>
                     </div>
              </div>

              <div class="col-md-4" [ngClass]="{'disableForm':service.allFieldsDisable}">
                <label>Evidence of Addition/Alterations* :</label>
                <select class="form-control" formControlName="evidenceAlterations" (change)="showEstimatedAge($event)" 
                [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable"
                 [(ngModel)]="reportDetails.evidanceAddition" [ngClass]="{ 'is-invalid': submitted && f.evidenceAlterations.errors }">
                 <option value="" selected>Select Option</option>
                  <option *ngFor="let value of evidenceList" >{{value}}</option>
                </select>
                <div *ngIf="submitted && f.evidenceAlterations.errors" class="invalid-feedback">
                  <div *ngIf="f.evidenceAlterations?.errors?.required">Evidence is required</div>
              </div>
              </div>

              <div class="col-md-4" [ngClass]="{'disableForm':service.allFieldsDisable}" *ngIf="showField2" style="margin-top: 35px;">
                <label>If Yes Estimated Age Years:</label>
                  <input type="number" min="0" formControlName="showField2" [readonly]="service.allFieldsDisable" style="
                  width: 50px;
                  background: transparent;
                  border: none;
                  border-bottom: 1px solid #000000;"
                  [(ngModel)]="reportDetails.evidanceWireAge"
                  [ngClass]="{ 'is-invalid': submitted && f.showField2.errors }">
                <div *ngIf="submitted && f.showField2.errors" class="invalid-feedback">
                  <div *ngIf="f.showField2?.errors?.required">Field Is Required</div>
                </div>
              </div>
              

              <div class="col-md-4" [ngClass]="{'disableForm':service.allFieldsDisable}">
                <label>Previous Records Available* :</label>
                <select class="form-control" formControlName="previousRecord" (change)="previousRecord($event)" 
                [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable"
                [(ngModel)]="reportDetails.previousRecords" [ngClass]="{ 'is-invalid': submitted && f.previousRecord.errors }">
                 <option value="" selected>Select Option</option>
                  <option *ngFor="let value of previousRecordList" >{{value}}</option>
                </select>
                <div *ngIf="submitted && f.previousRecord.errors" class="invalid-feedback">
                  <div *ngIf="f.previousRecord?.errors?.required">Previous record is required</div>
                </div>
              </div>

              <div class="col-md-4" [ngClass]="{'disableForm':service.allFieldsDisable}" *ngIf="lastInspectionDate">
                <label>Last Date Of Inspection* :</label>
                <input type="date" class="form-control" formControlName="inspectionLast" placeholder="Enter Date" [readonly]="service.allFieldsDisable"
                [(ngModel)]="reportDetails.lastInspection" [ngClass]="{ 'is-invalid': submitted && f.inspectionLast.errors }">
                <div *ngIf="submitted && f.inspectionLast.errors" class="invalid-feedback">
                  <div *ngIf="f.inspectionLast?.errors?.required">Inspection last date is required</div>
                </div>
              </div>
            </div>
 
            <div class="row">
              <div class="col-md-4">
                <mat-form-field class="client-description ">
                  <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 55%;margin-top: 0.7%;"
                  matTooltip="Building/block/floor details covered in this report."
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
                 </mat-icon>
                  <mat-label><h3>Extent of Installation Covered By This Report*</h3> </mat-label>
                  <textarea matInput class="client-box-description" formControlName="extentInstallation"
                  maxlength="500" placeholder="Ex. Report reason..." [readonly]="service.allFieldsDisable"
                  [(ngModel)]="reportDetails.extentInstallation"
                  [ngClass]="{ 'is-invalid': submitted && f.extentInstallation.errors }"></textarea>
                  <div *ngIf="submitted && f.extentInstallation.errors" class="invalid-feedback">
                    <div *ngIf="f.extentInstallation?.errors?.required">Field Is Required</div>
                  </div>
                </mat-form-field>
              </div>
            </div>

          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Details Of Client / Person Ordering This Report </h3>
                <!-- <mat-icon style="float: right;font-size: 18px;
                line-height: unset;margin-left: 1%;"
                matTooltip="Viewer assigned during site creation"
                matTooltipClass="example-tooltip-red"
                aria-label="Button that shows a red tooltip"
                class="example-button">
                info_outline
               </mat-icon> -->
              </mat-panel-title>

            </mat-expansion-panel-header>

            <div class="row">
              <div class="col-md-4">
                <mat-form-field class="client-description ">
                  <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 65%;margin-top: -2%;"
                  matTooltip="Viewer assigned during site creation."
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
                 </mat-icon>
                  <mat-label><h3>Details Of Client / Person Ordering This Report</h3></mat-label>
                  <textarea matInput class="client-box-description" formControlName="detailsOfClient" [disabled]="service.allFieldsDisable"
                  [ngClass]="{ 'is-invalid': submitted && f.detailsOfClient.errors }" readonly style="background-color: #e9ecef;"
                  placeholder="Ex. Name, address ,purpose ,relation with end user.." 
                  [(ngModel)]="reportDetails.clientDetails"></textarea>
                  <div *ngIf="submitted && f.detailsOfClient.errors" class="invalid-feedback">
                    <div *ngIf="f.detailsOfClient?.errors?.required">Details Of client is required</div>
                </div>
                </mat-form-field>
              </div>
            </div>
           
            <div class="form-group" [ngClass]="{'disableForm':service.allFieldsDisable}">
              <div class="row">
                <!-- <div class="col-md-4">
                  <label>Details Of Client / Person Ordering This Report</label>
                    <input type="text" readonly class="form-control" formControlName="detailsOfClient"
                    [ngClass]="{ 'is-invalid': submitted && f.detailsOfClient.errors }" [(ngModel)]="reportDetails.clientDetails">
                    <div *ngIf="submitted && f.detailsOfClient.errors" class="invalid-feedback">
                      <div *ngIf="f.detailsOfClient?.errors?.required">Details Of client is required</div>
                  </div>
                </div> -->
                <div class="col-md-4">
                  <label>Designation* :</label>
                  <input type="text" class="form-control" readonly formControlName="designation" placeholder="Enter Designation" 
                  [(ngModel)]="reportDetails.designation" [ngClass]="{ 'is-invalid': submitted && f.designation.errors }">
                  <div *ngIf="submitted && f.designation.errors" class="invalid-feedback">
                    <div *ngIf="f.designation?.errors?.required">Designation is required</div>
                </div>
                </div>
                <div class="col-md-4">
                  <label>Company* :</label>
                  <input type="text" class="form-control" readonly formControlName="companyName" placeholder="Enter Company Name" [(ngModel)]="reportDetails.company" [ngClass]="{ 'is-invalid': submitted && f.companyName.errors }">
                  <div *ngIf="submitted && f.companyName.errors" class="invalid-feedback">
                    <div *ngIf="f.companyName?.errors?.required">Company name is required</div>
                </div>
                </div>
              </div>
            </div>

            

            <h1>Inspector Details:</h1>
            <div class="form-group" [ngClass]="{'disableForm':service.allFieldsDisable}">
              <div class="row">
                <div class="col-md-4">
                  <label>Name of Engineer Who Carries Out Verification * :</label>
                  <input type="text" class="form-control" readonly formControlName="engineerName" placeholder="Enter Engineer Name" [(ngModel)]="reportDetails.verifiedEngineer" [ngClass]="{ 'is-invalid': submitted && f.engineerName.errors }">
                  <div *ngIf="submitted && f.engineerName.errors" class="invalid-feedback">
                    <div *ngIf="f.engineerName?.errors?.required">Engineer name is required</div>
                </div>
                </div>

                <div class="col-md-4">
                  <label>Designation* :</label>
                  <input type="text" class="form-control" readonly formControlName="inspectorDesignation" placeholder="Enter Designation" 
                  [(ngModel)]="reportDetails.inspectorDesignation" [ngClass]="{ 'is-invalid': submitted && f.inspectorDesignation.errors }">
                  <div *ngIf="submitted && f.inspectorDesignation.errors" class="invalid-feedback">
                    <div *ngIf="f.inspectorDesignation?.errors?.required">Designation is required</div>
                </div>
                </div>

                <div class="col-md-4">
                  <label>Company* :</label>
                  <input type="text" class="form-control" readonly formControlName="inspectorCompanyName" placeholder="Enter Company Name" [(ngModel)]="reportDetails.inspectorCompanyName" [ngClass]="{ 'is-invalid': submitted && f.inspectorCompanyName.errors }">
                  <div *ngIf="submitted && f.inspectorCompanyName.errors" class="invalid-feedback">
                    <div *ngIf="f.inspectorCompanyName?.errors?.required">Company name is required</div>
                </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-4">
                <mat-form-field class="client-description ">
                  <mat-icon style="float: right;font-size: 18px;
                  line-height: unset;margin-right: 32%;"
                  matTooltip="Distribution board details covered in this report."
                  matTooltipClass="multiline-tooltip"
                  aria-label="Button that shows a red tooltip"
                  class="example-button">
                  info_outline
                 </mat-icon>
                  <mat-label><h3>Details Of Installation Referred In This Report * (maximum length is 75 )</h3></mat-label>
                  <textarea matInput class="client-box-description" formControlName="detailsOfInstallation" maxlength="75" 
                  [ngClass]="{ 'is-invalid': submitted && f.detailsOfInstallation.errors }" [readonly]="service.allFieldsDisable"
                  placeholder="Ex. Occupier ,address details etc.." [(ngModel)]="reportDetails.installationDetails"></textarea>
                  <div *ngIf="submitted && f.detailsOfInstallation.errors" class="invalid-feedback">
                    <div *ngIf="f.detailsOfInstallation?.errors?.required">Details Of installation is required</div>
                </div>
                </mat-form-field>
              </div>
            </div>
<br>
            <div class="form-group" [ngClass]="{'disableForm':service.allFieldsDisable}">
              <div class="row">
                <div class="col-md-4">
                  <label>Date of Starting the Verification *</label>
                  <input type="date" class="form-control" formControlName="startingDateVerification"
                  [ngClass]="{ 'is-invalid': submitted && f.startingDateVerification.errors }" placeholder="Enter Date" 
                  [(ngModel)]="reportDetails.verificationDate" [readonly]="service.allFieldsDisable">
                  <div *ngIf="submitted && f.startingDateVerification.errors" class="invalid-feedback">
                    <div *ngIf="f.startingDateVerification?.errors?.required">Field Is Required</div>
                </div>
                </div>
                
                <div class="col-md-4">
                  <label>Read and Confirmed the Extent and Limitations* :</label>
                  <select class="form-control" formControlName="limitations" [(ngModel)]="reportDetails.limitations" 
                  [ngClass]="{ 'is-invalid': submitted && f.limitations.errors }" [tabindex]="service.allFieldsDisable ? -1 : 0" 
                  [disabled]="service.allFieldsDisable">
                   <option value="" selected>Select Option</option>
                    <option *ngFor="let value of previousRecordList">{{value}}</option>
                  </select>
                  <div *ngIf="submitted && f.limitations.errors" class="invalid-feedback">
                    <div *ngIf="f.limitations?.errors?.required">Field Is Required</div>
                  </div>
                </div>
              </div>
            </div>



          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Liability and Declaration</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-icon style="float: right;font-size: 18px;
            line-height: unset;margin-right: 68%;margin-top: 0.4%;"
            matTooltip="Person/organisation who designed the installation, if don’t know fill the details as unknown."
            matTooltipClass="multiline-tooltip"
            aria-label="Button that shows a red tooltip"
            class="example-button">
            info_outline
    </mat-icon>
            <h3><b>Declaration of Designer of the Electrical Installation:</b></h3>
            <div class="form-group">
                <p>
                  I/we being the person responsible for the design of the electrical installation (as indicated by my/our signatures below), particulars of which are described above, having exercised reasonable skill and care when carrying out the design hereby <b>declare</b> that design work for which I/We have been responsible is to the best of my/our knowledge and belief in accordance with IEC 60364
                </p>
                <p>
                  The extent of liability of the signatory or signatories is limited to the work described above as the subject of this report.
                </p>
                <!-- (focus)="focusFunction(contentSig)" -->
                <div formArrayName="designer1AcknowledgeArr" *ngFor="let a of getDesigner1AcknowledgeControls(); let i = index">
                  <div class="form-group" [formGroupName]="i" [ngClass]="{'disableForm':service.allFieldsDisable}">
                    <h2>Designer 1* :</h2>
                    <div class="row">
                      <div class="col-md-4">
                        <label>Signature:</label>
                        <input type="text" formControlName="declarationSignature" class="form-control"
                        readonly
                        [ngClass]="{ 'is-invalid': submitted && a.get('declarationSignature')?.errors }">
                          <div *ngIf="submitted && a.get('declarationSignature')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationSignature')?.errors?.required">Signature is required</div>
                        </div>
                      </div>

                      <div class="col-md-4">
                        <label>Date:</label>

                        <input type="date" formControlName="declarationDate" class="form-control" placeholder="Enter Date"
                        [ngClass]="{ 'is-invalid': submitted && a.get('declarationDate')?.errors }" [readonly]="service.allFieldsDisable">

                          <div *ngIf="submitted && a.get('declarationDate')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationDate')?.errors?.required">Date is required</div>
                        </div>
                      </div>

                      <div class="col-md-4">
                        <label>Name (In block letters) :</label>
                        <input type="text" formControlName="declarationName" class="form-control" placeholder="Enter Designer Name"
                        [ngClass]="{ 'is-invalid': submitted && a.get('declarationName')?.errors }" 
                        (keyup)="onKeyPersonName($event)" [(ngModel)]="declarationPersonName" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('declarationName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationName')?.errors?.required">Name (In block letters) is required</div>
                        </div>
                      </div>
                    </div>

                  </div>
                </div>

              <div formArrayName="designer2AcknowledgeArr" *ngFor="let a of getDesigner2AcknowledgeControls(); let i = index">
                <div class="form-group" [formGroupName]="i" [ngClass]="{'disableForm':service.allFieldsDisable}">
                   <h2>Designer 2: (Optional)</h2>
                    <div class="row">
                      <div class="col-md-4">
                        <label>Signature:</label>
                        <input type="text" formControlName="declarationSignature" class="form-control" readonly>
                      </div>
                      <div class="col-md-4">
                        <label>Date:</label>
                        <input type="date" formControlName="declarationDate" class="form-control" placeholder="Enter Date" [readonly]="service.allFieldsDisable">
                      </div>

                      <div class="col-md-4">
                        <label>Name (In block letters) :</label>
                        <input type="text" formControlName="declarationName" class="form-control" placeholder="Enter Designer Name"
                        [(ngModel)]="designer2PersonName" (keyup)="onKeyDesigner2PersonName($event)" [readonly]="service.allFieldsDisable">
                      </div>
                    </div>

                  </div>
                </div>
            </div>

            <div class="form-group">
             
                <h3><b>Declaration of Contractor of Installation:</b></h3>
                <mat-icon style="float: right;font-size: 18px;
                line-height: unset;margin-right: 74%;margin-top: -3%;"
                matTooltip="Person/organisation who will do the installation, if don’t know fill the details as unknown."
                matTooltipClass="multiline-tooltip"
                aria-label="Button that shows a red tooltip"
                class="example-button">
                info_outline
        </mat-icon>
                  <p>
                    I/we being the person responsible for the construction of the electrical installation (as indicated by my/our signatures below), particulars of which are described above, having exercised reasonable skill and care when carrying out the design hereby <b>declare</b> that the design work for which I/We have been responsible is to the best of my/our knowledge and belief in accordance with IEC 60364
                  </p>
                  <p>
                    The extent of liability of the signatory is limited to the work described above as the subject of this report.
                  </p>

                  <div formArrayName="contractorAcknowledgeArr" *ngFor="let a of getContractorAcknowledgeControls(); let i = index">
                    <div class="form-group" [formGroupName]="i">
                      <h2>Contractor* :</h2>
                      <div class="row">
                        <div class="col-md-4">
                          <label>Signature:</label>
                          <input type="text" formControlName="declarationSignature" class="form-control" readonly
                          [ngClass]="{ 'is-invalid': submitted && a.get('declarationSignature')?.errors }">
                          <div *ngIf="submitted && a.get('declarationSignature')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationSignature')?.errors?.required">Signature is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                          <label>Date:</label>
                          <input type="date" formControlName="declarationDate" class="form-control" placeholder="Enter Date"
                          [ngClass]="{ 'is-invalid': submitted && a.get('declarationDate')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('declarationDate')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationDate')?.errors?.required">Date is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                          <label>Name (In block letters) :</label>
                          <input type="text" formControlName="declarationName" class="form-control" placeholder="Enter Contractor Name"
                          [ngClass]="{ 'is-invalid': submitted && a.get('declarationName')?.errors }" [(ngModel)]="ContractorPersonName"
                          (keyup)="onKeyContractorPersonName($event)" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('declarationName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationName')?.errors?.required">Name (In block letters) is required</div>
                        </div>
                        </div>
                      </div>

                    </div>
                  </div>
            </div>

            <div class="form-group" [ngClass]="{'disableForm':service.allFieldsDisable}">
                <h3><b>Declaration of Safety Engineer (Inspector):</b></h3>
                  <p>
                    I/we being the person responsible for the inspection & testing  of the electrical installation (as indicated by my/our signatures below), particulars of which are described above, having exercised reasonable skill and care when carrying out the design hereby <b>declare</b> that the design work for which I/We have been responsible is to the best of my/our knowledge and belief in accordance with IEC 60364
                  </p>
                  <p>
                    The extent of liability of the signatory is limited to the work described above as the subject of this report.
                  </p>
                  <div formArrayName="inspectorAcknowledgeArr" *ngFor="let a of getInspectorAcknowledgeControls(); let i = index">
                    <div class="form-group" [formGroupName]="i">

                      <h2>Inspector* :</h2>
                      <div class="row">
                        <div class="col-md-4">
                          <label>Signature:</label>
                          <input type="text" formControlName="declarationSignature" class="form-control" readonly
                          [ngClass]="{ 'is-invalid': submitted && a.get('declarationSignature')?.errors }">
                          <div *ngIf="submitted && a.get('declarationSignature')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationSignature')?.errors?.required">Signature is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                          <label>Date:</label>
                          <input type="date" formControlName="declarationDate" class="form-control" placeholder="Enter Date"
                          [ngClass]="{ 'is-invalid': submitted && a.get('declarationDate')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('declarationDate')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationDate')?.errors?.required">Date is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                          <label>Name (In block letters) :</label>
                          <input type="text" formControlName="declarationName" class="form-control" placeholder="Enter Inspector Name"
                          [ngClass]="{ 'is-invalid': submitted && a.get('declarationName')?.errors }" readonly>
                          <div *ngIf="submitted && a.get('declarationName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('declarationName')?.errors?.required">Name (In block letters) is required</div>
                        </div>
                        </div>
                      </div>

                    </div>
                  </div>
            </div>

          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Next Inspection</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <label>I/We recommend that installation is further inspected and tested after an interval of not more than: </label>
              <input type="number" min="0" [ngClass]="{ 'is-invalid': submitted && f.nextInspection.errors }" 
              [ngClass]="{'disableForm':service.allFieldsDisable}" [readonly]="service.allFieldsDisable" style="
              width: 75px;
              background: transparent;
              border: none;
              border-bottom: 1px solid #000000;"
            [(ngModel)]="reportDetails.nextInspection" formControlName="nextInspection" placeholder="Enter year">
            <div *ngIf="submitted && f.nextInspection.errors" class="invalid-feedback">
              <div *ngIf="f.nextInspection?.errors?.required">Field Is Required</div>
          </div>
          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Details Of Signatories To The Verification Report</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <h2>Designer Details</h2>

            <mat-icon *ngIf="showAddButton" class="mousechange" (click)="addDesigner()" [ngClass]="{'disableForm':service.allFieldsDisable}"
            style="float:right; padding-right: 37px; padding-top: 10px;">add_box</mat-icon>

              <div formArrayName="designer1Arr" *ngFor="let a of getDesigner1Controls(); let i = index">
                <div class="form-group" [formGroupName]="i" [ngClass]="{'disableForm':service.allFieldsDisable}">
                  <h2>Designer 1*</h2>

                  <div class="form-group">
                    <div class="row">
                        <div class="col-md-4">
                            <label>Person Name:</label>
                            <input type="text"  formControlName="personName" class="form-control"  placeholder="Enter Person Name" 
                            readonly
                            [ngClass]="{ 'is-invalid': submitted && a.get('personName')?.errors }" [(ngModel)]="declarationPersonName"
                            (focus)="focusPersonFunction()">
                            <div *ngIf="showPersonNameMsg" class="invalid-feedback">
                             Please fill out the details in Liability and Declaration tab!
                            </div>
                          <div *ngIf="submitted && a.get('personName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personName')?.errors?.required">Person name is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                            <label>* Mobile Number:</label>
                            <input type="tel" ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                            (keypress)="keyPressNumbers($event)" (countryChange)="countryChange($event)" placeholder="Enter Mobile Number"
                             formControlName="personContactNo" class="form-control" [readonly]="setReadOnly"
                            [ngClass]="{ 'is-invalid': submitted && a.get('personContactNo')?.errors }">
                            <div *ngIf="submitted && a.get('personContactNo')?.errors" class="invalid-feedback">
                              <div *ngIf="a.get('personContactNo')?.errors?.required">Mobile Number is Required</div>
                              <div *ngIf="a.get('personContactNo')?.errors?.minlength">Please Enter 10 Digit Number</div> 
                              <div *ngIf="a.get('personContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div>
                          </div>
                        </div>

                        <div class="col-md-4">
                            <label>Email:</label>
                            <input type="email"  formControlName="personMailID" class="form-control"  placeholder="Enter Email Address"
                            [ngClass]="{ 'is-invalid': submitted && a.get('personMailID')?.errors }" [readonly]="service.allFieldsDisable">
                            <div *ngIf="submitted && a.get('personMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('personMailID')?.errors?.pattern">Enter valid email</div>
                        </div>
                        </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <div class="row">
                        <div class="col-md-4">
                            <label>Manager Name:</label>
                            <input type="text"  formControlName="managerName" class="form-control"  placeholder="Enter Manager Name"
                            [ngClass]="{ 'is-invalid': submitted && a.get('managerName')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('managerName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerName')?.errors?.required">Manager name is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                          <label>* Mobile Number (Optional):</label>
                          <input type="tel" ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                          (keypress)="keyPressNumbers($event)" (countryChange)="countryChange1($event)" [readonly]="setReadOnly"
                          formControlName="managerContactNo" class="form-control" placeholder="Enter Mobile Number"
                          [ngClass]="{ 'is-invalid': submitted && a.get('managerContactNo')?.errors }">
                          <div *ngIf="submitted && a.get('managerContactNo')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerContactNo')?.errors?.minlength">Please Enter 10 Digit Number</div> 
                            <div *ngIf="a.get('managerContactNo')?.errors?.required">Mobile Number is Required</div>
                            <div *ngIf="a.get('managerContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                            <label>Email:</label>
                            <input type="email"  formControlName="managerMailID" class="form-control"  placeholder="Enter Email Address"
                            [ngClass]="{ 'is-invalid': submitted && a.get('managerMailID')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('managerMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('managerMailID')?.errors?.pattern">Enter valid email</div>
                        </div>
                        </div>
                    </div>
                  </div>


                  <div class="form-group">
                      <div class="row">
                          <div class="col-md-4">
                              <label>Company Name:</label>
                              <input type="text"  formControlName="companyName" class="form-control"  placeholder="Enter Company Name"
                              [ngClass]="{ 'is-invalid': submitted && a.get('companyName')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('companyName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('companyName')?.errors?.required">Company name is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>Address Line1:</label>
                              <input type="text"  formControlName="addressLine1" class="form-control"  placeholder="Enter Address Line1"
                              [ngClass]="{ 'is-invalid': submitted && a.get('addressLine1')?.errors}" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('addressLine1')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine1')?.errors?.required">AddressLine1 is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>Address Line2: (Optional)</label>
                              <input type="text"  formControlName="addressLine2" class="form-control"  placeholder="Enter Address Line2"
                              [ngClass]="{ 'is-invalid': submitted && a.get('addressLine2')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('addressLine2')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine2')?.errors?.required">AddressLine2 is required</div>
                        </div>
                          </div>
                      </div>
                  </div>

                  <div class="form-group">
                    <div class="row">
                        <div class="col-md-4">
                            <label>Site Landmark: (Optional)</label>
                            <input type="text"  formControlName="landMark" class="form-control"  placeholder="Enter Landmark"
                            [ngClass]="{ 'is-invalid': submitted && a.get('landMark')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('landMark')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('landMark')?.errors?.required">Site Landmark is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                            <label>Country:</label>
                            <select  formControlName="country" class="form-control" (change)="designer1changeCountry($event)"
                            [ngClass]="{ 'is-invalid': submitted && a.get('country')?.errors }" 
                            [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable">

                               <option value="" selected>Select Country Name</option>
                                <option *ngFor="let country of countryList" [selected]="country.name=== a.get('country')?.value">{{country.name}}</option>
                            </select>
                            <div *ngIf="submitted && a.get('country')?.errors" class="invalid-feedback">
                              <div *ngIf="a.get('country')?.errors?.required">Country is required</div>
                          </div>
                        </div>

                        <div class="col-md-4">
                            <label>State:</label>
                            <select  formControlName="state" class="form-control"
                            [ngClass]="{ 'is-invalid': submitted && a.get('state')?.errors}" 
                            [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable">
                             <!--<option value="" selected>{{state1}}</option> -->
                                <option value="" >Select State Name</option>
                                <option *ngFor="let state of stateList1" [selected]="state.name=== state1">{{state.name}}</option>
                            </select>
                            <div *ngIf="submitted && a.get('state')?.errors" class="invalid-feedback">
                              <div *ngIf="a.get('state')?.errors?.required">State is required</div>
                          </div>
                        </div>
                    </div>
                  </div>

                  <div class="form-group">
                      <div class="row">
                          <div class="col-md-4">
                              <label>Pincode:</label>
                              <input type="text"  formControlName="pinCode" class="form-control" (keypress)="keyPressNumbers($event)" minlength="6" maxlength="6" placeholder="Enter Pincode"
                              [ngClass]="{ 'is-invalid': submitted && a.get('pinCode')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('pinCode')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('pinCode')?.errors?.required">Pincode is required</div>
                            <div *ngIf="a.get('pinCode')?.errors?.maxlength">Enter Six Digit Numbers</div>
                            <div *ngIf="a.get('pinCode')?.errors?.minlength">Enter Six Digit Numbers</div>
                        </div>
                          </div>
                      </div>
                  </div>
                </div>
              </div>

              <div *ngIf="showDesigner2">
                <mat-icon class="mousechange" class="dlt" type="button" [ngClass]="{'disableForm':service.allFieldsDisable}" (click)="removeDesigner()" title="Delete" style="float:right; padding-right: 37px; padding-top: 10px;">remove_circle_outline</mat-icon>

                <!-- <mat-icon class="mousechange"  (click)="removeDesigner()" style="">delete</mat-icon> -->

                <div formArrayName="designer2Arr" *ngFor="let a of getDesigner2Controls(); let i = index">
                  <div class="form-group" [formGroupName]="i" [ngClass]="{'disableForm':service.allFieldsDisable}">
                    <h2>Designer 2 (Optional)</h2>

                    <div class="form-group" >
                      <div class="row">
                          <div class="col-md-4">
                              <label>Person Name:</label>
                              <input type="text"  formControlName="personName" class="form-control"  placeholder="Enter Person Name" readonly
                              [ngClass]="{ 'is-invalid': submitted && a.get('personName')?.errors }"
                              (focus)="designer2PersonFunction()" [(ngModel)]="designer2PersonName">
                            <div *ngIf="designer2PersonNameMsg" class="invalid-feedback">
                             Please fill out the details in Liability and Declaration tab!
                            </div>
                          <div *ngIf="submitted && a.get('personName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personName')?.errors?.required">Person name is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                            <label>* Mobile Number:</label>
                            <input type="tel" ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                            (keypress)="keyPressNumbers($event)" (countryChange)="countryChange2($event)" placeholder="Enter Mobile Number"
                             formControlName="personContactNo" class="form-control" [readonly]="setReadOnly1"
                            [ngClass]="{ 'is-invalid': submitted && a.get('personContactNo')?.errors }">
                            <div *ngIf="submitted && a.get('personContactNo')?.errors" class="invalid-feedback">
                              <div *ngIf="a.get('personContactNo')?.errors?.required">Mobile Number is Required</div>
                              <div *ngIf="a.get('personContactNo')?.errors?.minlength">Please Enter 10 Digit Number</div> 
                              <div *ngIf="a.get('personContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div>
                          </div>
                          </div>

                          <div class="col-md-4">
                              <label>Email:</label>
                              <input type="email"  formControlName="personMailID" class="form-control"  placeholder="Enter Email Address"
                              [ngClass]="{ 'is-invalid': submitted && a.get('personMailID')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('personMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('personMailID')?.errors?.pattern">Enter valid email</div>
                        </div>
                          </div>
                      </div>
                    </div>

                    <div class="form-group">
                      <div class="row">
                          <div class="col-md-4">
                              <label>Manager Name:</label>
                              <input type="text"  formControlName="managerName" class="form-control"  
                              placeholder="Enter Manager Name" [readonly]="service.allFieldsDisable"
                              [ngClass]="{ 'is-invalid': submitted && a.get('managerName')?.errors }">
                          <div *ngIf="submitted && a.get('managerName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerName')?.errors?.required">Manager name is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                            <label>* Mobile Number (Optional):</label>
                            <input type="tel" ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                            (keypress)="keyPressNumbers($event)" (countryChange)="countryChange3($event)" formControlName="managerContactNo" class="form-control" placeholder="Enter Mobile Number"
                            [readonly]="setReadOnly1" [ngClass]="{ 'is-invalid': submitted && a.get('managerContactNo')?.errors }">
                            <div *ngIf="submitted && a.get('managerContactNo')?.errors" class="invalid-feedback">
                              <div *ngIf="a.get('managerContactNo')?.errors?.required">Mobile Number is Required</div>
                              <div *ngIf="a.get('managerContactNo')?.errors?.minlength">Please Enter 10 Digit Number</div> 
                              <div *ngIf="a.get('managerContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div>
                          </div>
                          </div>

                          <div class="col-md-4">
                              <label>Email:</label>
                              <input type="email"  formControlName="managerMailID" class="form-control"  placeholder="Enter Email Address"
                              [ngClass]="{ 'is-invalid': submitted && a.get('managerMailID')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('managerMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('managerMailID')?.errors?.pattern">Enter valid email</div>
                        </div>
                          </div>
                      </div>
                    </div>


                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                <label>Company Name:</label>
                                <input type="text"  formControlName="companyName" class="form-control"  
                                placeholder="Enter Company Name"
                                [ngClass]="{ 'is-invalid': submitted && a.get('companyName')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('companyName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('companyName')?.errors?.required">Company name is required</div>
                        </div>
                            </div>

                            <div class="col-md-4">
                                <label>Address Line1:</label>
                                <input type="text"  formControlName="addressLine1" class="form-control"  placeholder="Enter Address Line1"
                                [ngClass]="{ 'is-invalid': submitted && a.get('addressLine1')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('addressLine1')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine1')?.errors?.required">AddressLine1 is required</div>
                        </div>
                            </div>

                            <div class="col-md-4">
                                <label>Address Line2: (Optional)</label>
                                <input type="text"  formControlName="addressLine2" class="form-control"  placeholder="Enter Address Line2"
                                [ngClass]="{ 'is-invalid': submitted && a.get('addressLine2')?.errors}" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('addressLine2')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine2')?.errors?.required">AddressLine2 is required</div>
                        </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                <label>Site Landmark: (Optional)</label>
                                <input type="text"  formControlName="landMark" class="form-control"  placeholder="Enter Landmark"
                                [ngClass]="{ 'is-invalid': submitted && a.get('landMark')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('landMark')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('landMark')?.errors?.required">Site Landmark is required</div>
                        </div>
                            </div>

                            <div class="col-md-4">
                                <label>Country:</label>
                                <select  formControlName="country" class="form-control" (change)="designer2changeCountry($event)"
                                [ngClass]="{ 'is-invalid': submitted && a.get('country')?.errors }" 
                                [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable">
                               <option value="" selected>Select Country Name</option>
                                <option *ngFor="let country of countryList" [selected]="country.name=== a.get('country')?.value">{{country.name}}</option>
                            </select>
                                <div *ngIf="submitted && a.get('country')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('country')?.errors?.required">Country is required</div>
                        </div>

                            </div>

                            <div class="col-md-4">
                                <label>State:</label>
                                <select  formControlName="state" class="form-control"
                                [ngClass]="{ 'is-invalid': submitted && a.get('state')?.errors }" 
                                [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable">
                               <option value="" selected>Select State Name</option>
                                <option *ngFor="let state of stateList2" [selected]="state.name=== state2">{{state.name}}</option>
                            </select>
                                <div *ngIf="submitted && a.get('state')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('state')?.errors?.required">State is required</div>
                        </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                <label>Pincode:</label>
                                <input type="text"  formControlName="pinCode" class="form-control" (keypress)="keyPressNumbers($event)" minlength="6" maxlength="6" placeholder="Enter Pincode"
                                [ngClass]="{ 'is-invalid': submitted && a.get('pinCode')?.errors}" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('pinCode')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('pinCode')?.errors?.required">Pincode is required</div>
                            <div *ngIf="a.get('pinCode')?.errors?.maxlength">Enter Six Digit Numbers</div>
                            <div *ngIf="a.get('pinCode')?.errors?.minlength">Enter Six Digit Numbers</div>
                        </div>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
              </div>
          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Details Of Contractor</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <h2>Contractor Details*</h2>

              <div formArrayName="contractorArr" *ngFor="let a of getContractorControls(); let i = index">
                  <div class="form-group" [formGroupName]="i" [ngClass]="{'disableForm':service.allFieldsDisable}">

                    <div class="form-group" >
                      <div class="row">
                          <div class="col-md-4">
                              <label>Person Name:</label>
                              <input type="text"  formControlName="personName" class="form-control"  placeholder="Enter Person Name"
                              [ngClass]="{ 'is-invalid': submitted && a.get('personName')?.errors }" [(ngModel)]="ContractorPersonName" readonly 
                              (focus)="ContractorPersonFunction()">
                              <div *ngIf="ContractorPersonNameMsg" class="invalid-feedback">
                               Please fill out the details in Liability and Declaration tab!
                              </div>
                          <div *ngIf="submitted && a.get('personName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personName')?.errors?.required">Person name is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>* Mobile Number:</label>
                              <input type="tel" ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                              (keypress)="keyPressNumbers($event)" (countryChange)="countryChange4($event)"  [readonly]="setReadOnly" formControlName="personContactNo" class="form-control" placeholder="Enter Mobile Number"
                              [ngClass]="{ 'is-invalid': submitted && a.get('personContactNo')?.errors }">
                              <div *ngIf="submitted && a.get('personContactNo')?.errors" class="invalid-feedback">
                                <div *ngIf="a.get('personContactNo')?.errors?.required">Mobile Number is Required</div>
                                 <div *ngIf="a.get('personContactNo')?.errors?.minlength">Please Enter 10 Digit Number</div>
                                <div *ngIf="a.get('personContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>Email:</label>
                              <input type="email"  formControlName="personMailID" class="form-control"  placeholder="Enter Email Address"
                              [ngClass]="{ 'is-invalid': submitted && a.get('personMailID')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('personMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('personMailID')?.errors?.pattern">Enter valid email</div>
                          </div>
                          </div>
                      </div>
                    </div>


                    <div class="form-group">
                      <div class="row">
                          <div class="col-md-4">
                              <label>Manager Name:</label>
                              <input type="text"  formControlName="managerName" class="form-control"  placeholder="Enter Manager Name"
                              [ngClass]="{ 'is-invalid': submitted && a.get('managerName')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('managerName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerName')?.errors?.required">Manager name is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                            <label>* Mobile Number (Optional):</label>
                            <input type="tel" ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                            (keypress)="keyPressNumbers($event)" (countryChange)="countryChange5($event)" [readonly]="setReadOnly" formControlName="managerContactNo" class="form-control" placeholder="Enter Mobile Number"
                            [ngClass]="{ 'is-invalid': submitted && a.get('managerContactNo')?.errors }">
                          <div *ngIf="submitted && a.get('managerContactNo')?.errors" class="invalid-feedback">
                              <div *ngIf="a.get('managerContactNo')?.errors?.required">Mobile Number is Required</div>
                              <div *ngIf="a.get('managerContactNo')?.errors?.minlength">Please Enter 10 Digit Number</div> 
                              <div *ngIf="a.get('managerContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>Email:</label>
                              <input type="email"  formControlName="managerMailID" class="form-control"  placeholder="Enter Email Address"
                              [ngClass]="{ 'is-invalid': submitted && a.get('managerMailID')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('managerMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('managerMailID')?.errors?.pattern">Enter valid email</div>
                          </div>
                          </div>
                      </div>
                    </div>


                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                <label>Company Name:</label>
                                <input type="text"  formControlName="companyName" class="form-control"  placeholder="Enter Company Name"
                                [ngClass]="{ 'is-invalid': submitted && a.get('companyName')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('companyName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('companyName')?.errors?.required">Company name is required</div>
                        </div>
                            </div>

                            <div class="col-md-4">
                                <label>Address Line1:</label>
                                <input type="text"  formControlName="addressLine1" class="form-control"  placeholder="Enter Address Line1"
                                [ngClass]="{ 'is-invalid': submitted && a.get('addressLine1')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('addressLine1')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine1')?.errors?.required">AddressLine1 is required</div>
                        </div>
                            </div>

                            <div class="col-md-4">
                                <label>Address Line2: (Optional)</label>
                                <input type="text"  formControlName="addressLine2" class="form-control"  placeholder="Enter Address Line2"
                                [ngClass]="{ 'is-invalid': submitted && a.get('addressLine2')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('addressLine2')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine2')?.errors?.required">AddressLine2 is required</div>
                        </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                <label>Site Landmark: (Optional)</label>
                                <input type="text"  formControlName="landMark" class="form-control"  placeholder="Enter Landmark"
                                [ngClass]="{ 'is-invalid': submitted && a.get('landMark')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('landMark')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('landMark')?.errors?.required">Site Landmark is required</div>
                        </div>
                            </div>

                            <div class="col-md-4">
                                <label>Country:</label>
                                <select  formControlName="country" class="form-control" (change)="contractorchangeCountry($event)"
                                [ngClass]="{ 'is-invalid': submitted && a.get('country')?.errors }" 
                                [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable">
                               <option value="" selected>Select Country Name</option>
                                <option *ngFor="let country of countryList" [selected]="country.name=== a.get('country')?.value">{{country.name}}</option>
                            </select>
                                <div *ngIf="submitted && a.get('country')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('country')?.errors?.required">Country is required</div>
                        </div>

                            </div>

                            <div class="col-md-4">
                                <label>State:</label>
                                <select  formControlName="state" class="form-control"
                                [ngClass]="{ 'is-invalid': submitted && a.get('state')?.errors }" 
                                [tabindex]="service.allFieldsDisable ? -1 : 0" [disabled]="service.allFieldsDisable">
                                   <option value="" selected>Select State Name</option>
                                    <option *ngFor="let state of stateList3" [selected]="state.name=== state3">{{state.name}}</option>
                                </select>
                                <div *ngIf="submitted && a.get('state')?.errors" class="invalid-feedback">
                                  <div *ngIf="a.get('state')?.errors?.required">State is required</div>
                              </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                <label>Pincode:</label>
                                <input type="text"  formControlName="pinCode" class="form-control" (keypress)="keyPressNumbers($event)" minlength="6" maxLength="6" placeholder="Enter Pincode"
                                [ngClass]="{ 'is-invalid': submitted && a.get('pinCode')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('pinCode')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('pinCode')?.errors?.required">Pincode is required</div>
                            <div *ngIf="a.get('pinCode')?.errors?.maxlength">Enter Six Digit Numbers</div>
                            <div *ngIf="a.get('pinCode')?.errors?.minlength">Enter Six Digit Numbers</div>
                        </div>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>

          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Details Of Inspector</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <h2>Inspector Details*</h2>

              <div formArrayName="inspectorArr" *ngFor="let a of getInspectorControls(); let i = index">
                <div class="form-group" [formGroupName]="i" [ngClass]="{'disableForm':service.allFieldsDisable}">
                  <div class="form-group">
                    <div class="row">
                        <div class="col-md-4">
                            <label>Person Name:</label>
                            <input type="text" formControlName="personName" readonly class="form-control" placeholder="Enter Person Name"
                            [ngClass]="{ 'is-invalid': submitted && a.get('personName')?.errors }" >
                          <div *ngIf="submitted && a.get('personName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personName')?.errors?.required">Person name is required</div>
                        </div>
                         </div>
                        <div class="col-md-4">
                            <label>* Mobile Number:</label>
                            <input type="tel" ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                            (keypress)="keyPressNumbers($event)" (countryChange)="countryChange6($event)" readonly formControlName="personContactNo" class="form-control" placeholder="Enter Mobile Number"
                            [ngClass]="{ 'is-invalid': submitted && a.get('personContactNo')?.errors }">
                           <div *ngIf="submitted && a.get('personContactNo')?.errors" class="invalid-feedback">
                              <div *ngIf="a.get('personContactNo')?.errors?.required">Mobile Number is Required</div> 
                              <div *ngIf="a.get('personContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div> 
                           </div>
                        </div>

                        <div class="col-md-4">
                            <label>Email:</label>
                            <input type="email"  formControlName="personMailID" class="form-control" readonly placeholder="Enter Email Address"
                            [ngClass]="{ 'is-invalid': submitted && a.get('personMailID')?.errors }">
                          <div *ngIf="submitted && a.get('personMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('personMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('personMailID')?.errors?.pattern">Enter valid email</div>
                        </div>
                        </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <div class="row">
                        <div class="col-md-4">
                            <label>Manager Name:</label>
                            <input type="text"  formControlName="managerName" class="form-control"  placeholder="Enter Manager Name"
                            [ngClass]="{ 'is-invalid': submitted && a.get('managerName')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('managerName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerName')?.errors?.required">Manager name is required</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                          <label>* Mobile Number (Optional):</label>
                          <input type="tel"  ng2TelInput [ng2TelInputOptions]="{initialCountry: 'in',separateDialCode: 'true'}"
                          (keypress)="keyPressNumbers($event)" (countryChange)="countryChange7($event)" formControlName="managerContactNo" class="form-control" placeholder="Enter Mobile Number"
                          [readonly]="setReadOnly" [ngClass]="{ 'is-invalid': submitted && a.get('managerContactNo')?.errors}">
                          <div *ngIf="submitted && a.get('managerContactNo')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerContactNo')?.errors?.required">Mobile Number is Required</div>
                            <div *ngIf="a.get('managerContactNo')?.errors?.minlength">Please Enter 10 Digit Number</div> 
                            <div *ngIf="a.get('managerContactNo')?.errors?.maxlength">Please Enter 10 Digit Number</div>
                        </div>
                        </div>

                        <div class="col-md-4">
                            <label>Email:</label>
                            <input type="email"  formControlName="managerMailID" class="form-control"  placeholder="Enter Email Address"
                            [ngClass]="{ 'is-invalid': submitted && a.get('managerMailID')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('managerMailID')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('managerMailID')?.errors?.required">Email is required</div>
                            <div *ngIf="a.get('managerMailID')?.errors?.pattern">Enter valid email</div>
                        </div>
                        </div>
                    </div>
                  </div>


                  <div class="form-group">
                      <div class="row">
                          <div class="col-md-4">
                              <label>Company Name:</label>
                              <input type="text"  formControlName="companyName" class="form-control" readonly  placeholder="Enter Company Name"
                              [ngClass]="{ 'is-invalid': submitted && a.get('companyName')?.errors}">
                          <div *ngIf="submitted && a.get('companyName')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('companyName')?.errors?.required">Company name is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>Address Line1:</label>
                              <input type="text"  formControlName="addressLine1" class="form-control" readonly placeholder="Enter Address Line1"
                              [ngClass]="{ 'is-invalid': submitted && a.get('addressLine1')?.errors }">
                          <div *ngIf="submitted && a.get('addressLine1')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine1')?.errors?.required">AddressLine1 is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>Address Line2: (Optional)</label>
                              <input type="text"  formControlName="addressLine2" class="form-control"  placeholder="Enter Address Line2"
                              [ngClass]="{ 'is-invalid': submitted && a.get('addressLine2')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('addressLine2')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('addressLine2')?.errors?.required">AddressLine2 is required</div>
                        </div>
                          </div>
                      </div>
                  </div>

                  <div class="form-group">
                      <div class="row">
                          <div class="col-md-4">
                              <label>Site Landmark: (Optional)</label>
                              <input type="text"  formControlName="landMark" class="form-control"  placeholder="Enter Landmark"
                              [ngClass]="{ 'is-invalid': submitted && a.get('landMark')?.errors }" [readonly]="service.allFieldsDisable">
                          <div *ngIf="submitted && a.get('landMark')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('landMark')?.errors?.required">Site Landmark is required</div>
                        </div>
                          </div>

                          <div class="col-md-4">
                              <label>Country:</label>
                              <input type="text"  formControlName="country" class="form-control" readonly placeholder="Enter Landmark"
                              [ngClass]="{ 'is-invalid': submitted && a.get('country')?.errors }">
                              <!-- <select  formControlName="country" class="form-control"
                              (change)="inspectorchangeCountry($event)"
                              [ngClass]="{ 'is-invalid': submitted && a.get('country')?.errors }">
                             <option value="" selected>Select Country Name</option>
                              <option *ngFor="let country of countryList" [selected]="country.name=== a.get('country')?.value">{{country.name}}</option>
                          </select> -->
                              <div *ngIf="submitted && a.get('country')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('country')?.errors?.required">Country is required</div>
                        </div>

                          </div>

                          <div class="col-md-4">
                              <label>State:</label>
                              <input type="text"  formControlName="state" readonly class="form-control" placeholder="Enter State"
                              [ngClass]="{ 'is-invalid': submitted && a.get('state')?.errors }">
                              <!-- <select  formControlName="state" class="form-control"
                              [ngClass]="{ 'is-invalid': submitted && a.get('state')?.errors }">
                                 <option value="" selected>Select State Name</option>
                                  <option *ngFor="let state of stateList4" [selected]="state.name=== state4">{{state.name}}</option>
                              </select> -->
                              <div *ngIf="submitted && a.get('state')?.errors" class="invalid-feedback">
                                <div *ngIf="a.get('state')?.errors?.required">State is required</div>
                            </div>
                          </div>
                      </div>
                  </div>

                  <div class="form-group">
                      <div class="row">
                          <div class="col-md-4">
                              <label>Pincode:</label>
                              <input type="text"  formControlName="pinCode" class="form-control" readonly (keypress)="keyPressNumbers($event)" minlength="6" maxLength="6" placeholder="Enter Pincode"
                              [ngClass]="{ 'is-invalid': submitted && a.get('pinCode')?.errors }">
                          <div *ngIf="submitted && a.get('pinCode')?.errors" class="invalid-feedback">
                            <div *ngIf="a.get('pinCode')?.errors?.required">Pincode is required</div>
                            <div *ngIf="a.get('pinCode')?.errors?.maxlength">Enter Six Digit Numbers</div>
                            <div *ngIf="a.get('pinCode')?.errors?.minlength">Enter Six Digit Numbers</div>
                        </div>
                          </div>
                      </div>
                  </div>
                </div>
              </div>
          </mat-expansion-panel>


      <!-- comments start-->
          <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false" *ngIf="hideShowComment">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Comments</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
           
           <mat-progress-spinner style="margin: 0 auto;" *ngIf="spinner"
          color="primary"
           [mode]="mode"
           value="50"
          diameter="50">
       </mat-progress-spinner>

    <div class="card-body" style="padding: 0px;" *ngIf="cardBodyComments">
        <button class="btn dropdown" (click)="showSubmenu = !showSubmenu" style="width:100%;" 
        *ngIf="(isExpanded || isShowing) || (toggleHideShow || getViewerCommentControls().length > 2)">
          <mat-icon class="menu-button" [ngClass]="{'rotated' : showSubmenu}" style="float: left;">chevron_right</mat-icon> 
          <label style="float: left;">Check comments here!</label>
         </button> 
         <span *ngIf="getViewerCommentControls().length==0">No comments!</span>
         <mat-icon class="mousechange" (click)="refreshCommentSection()" style="float: right;"
         title="Refresh comment">refresh</mat-icon> 

    <div  formArrayName="viewerCommentArr" *ngFor="let a of getViewerCommentControls(); let i = index" 
    style="margin-left: 10px;">
      <div [formGroupName]="i" style="margin-left: 30px;">
        <div class="submenu" [ngClass]="{'expanded' : showSubmenu}" [ngStyle]="{'display': showSubmenu ? 'block' : 'none'}">
        
          <div class="input-group" [ngClass]="{even: i!=0}" style="align-items: end;">
            <div class="input-group-prepend" title="Viewer" style="height: 26px;">
                <span class="input-group-text" style="line-height: unset;">
                    <i class="bi bi-eye-fill"></i>
                </span>
            </div>
            <textarea cols="60" rows="1" formControlName="viewerComments" placeholder="Enter Viewer Comment">
           </textarea>

        <div style="display: flex;margin-left: 25px;" *ngIf="replyCommentBox">

                  <mat-icon class="mousechange" (click)="sendViewerComment(a)" [ngClass]="{'disable':disableSend== true}"
                  *ngIf="((a.get('inspectorComments')?.value=='' || a.get('inspectorComments')?.value==null) && sendComment)"
                  title="Send comment">send</mat-icon> &nbsp;&nbsp;&nbsp;&nbsp;

                  <mat-icon class="mousechange" (click)="replyToViewerComment(a)" 
                  *ngIf="((a.get('viewerComments')?.value!='') && (getViewerCommentControls().length-1 == i)) && hideAsViewerLogin "
                 title="Reply comment">reply</mat-icon>&nbsp;&nbsp;&nbsp;&nbsp;

                 <mat-icon class="mousechange" (click)="ViewerRemoveComment(i)" style="float:right;position: relative;left: 630%;"
                 *ngIf="(a.get('inspectorComments')?.value=='' || a.get('viewerComments')?.value=='') && hideDelete" >delete</mat-icon>
                 &nbsp;&nbsp;&nbsp;&nbsp;

                
          </div>
        </div>
        <span _ngcontent-nxx-c268="" class="spacer"></span>
        <!-- <mat-toolbar-row>
        <button mat-button style="min-width: unset;">
          {{a.value.viewerUserName}}
        </button>
        <button mat-button style="min-width: unset;">
          {{a.value.viewerDateTime | date:'dd-MM-YY hh:mm:ss a':'+0530'}}
        </button>
      </mat-toolbar-row> -->


          <span [ngClass]="i!=0 ? 'viewer' : 'even1'">
            {{a.value.viewerUserName}} {{a.value.viewerDateTime | date:'dd-MM-YY hh:mm:ss a':'+0530'}}
          </span>  

    <div *ngIf="replyCommentBox">

      <ul style="list-style-type:none;margin-bottom: 0rem;">
        <li> 

          <div class="input-group" style="align-items: end;"
          *ngIf="(a.get('inspectorComments')?.value!='' && a.get('inspectorComments')?.value!=null) || showReplyBox" >
            <div class="input-group-prepend" title="Inspector" style="height: 26px;">
                <span class="input-group-text" style="line-height: unset;">
                    <i class="bi bi-person-fill"></i>
                </span>
            </div>
            <textarea cols="60" rows="1" placeholder="Enter Inspector Comment" formControlName="inspectorComments" ></textarea>
         <div style="display: initial;margin-left: 25px;">

             <mat-icon class="mousechange" (click)="inspectorComment(a)" [ngClass]="{'disable':disableReply== true}"
             *ngIf="(getViewerCommentControls().length-1 == i) && SendReply" title="Send reply">send</mat-icon>

             <mat-icon class="mousechange" (click)="approveComment(a)" [ngClass]="{'disable':enabledRequest== true}"
             *ngIf="((getViewerCommentControls().length-1 == i) && hideapprove) && a.value.approveOrReject != 'REJECT'"
             title="Approve comment">thumb_up_alt</mat-icon> &nbsp;&nbsp;&nbsp;&nbsp;

             <mat-icon class="mousechange" (click)="rejectComment(a)" 
             [ngClass]="{'disable':a.value.approveOrReject === 'REJECT' || enabledRequest== true}"

              *ngIf="((getViewerCommentControls().length-1 == i) && hideReject) || 
              ((a.get('inspectorComments')?.value!='' || a.get('viewerComments')?.value!='') && a.value.approveOrReject=='REJECT')"
             title="Reject comment">thumb_down_alt</mat-icon>

             

             <mat-icon class="mousechange" (click)="addAnotherviewerComment()"
             *ngIf="((getViewerCommentControls().length-1 == i) && hideAdd) 
             || ((a.value.approveOrReject === 'REJECT' && getViewerCommentControls().length-1 == i) && addReject)"
              style="float:right;position: relative;left: 718%;" title="Add another comment">add_box</mat-icon>

         </div>
        </div>

         <span style="display: block;font-size: 11px;text-align: center;margin-left: -29%;">
          {{a.value.inspectorUserName}} {{a.value.inspectorDateTime | date:'dd-MM-YY hh:mm:ss a':'+0530'}}</span>  
               </li>
             </ul>
            </div> 
            </div>
            </div>
          </div> 
           
          </div>   
           
          </mat-expansion-panel>
<!-- comments end 
  [ngStyle]="{'pointer-events': a.value.approveOrReject === 'REJECT' ? 'none' : 'visible'}"
[ngClass]="{'rotated' : showHideAccordion(j)}"-->

  <!--   ng-class="{'test': obj.value1 == 'someothervalue' || obj.value2 == 'somethingelse'}" 
        (something && (menu1 || menu2)) ? even : ''
      [ngClass.class1]="menu1 || menu2" [ngClass.class2] = "(menu1 || menu2) && something"
    {{x.controls.completedCommentArr.controls[0].controls.viewerComments.value}}-->

 <!-- completed comments start-->
 <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false" *ngIf="completedComments">
  <mat-expansion-panel-header>
    <mat-panel-title>
      <h3>Completed Comments</h3>
    </mat-panel-title>
  
  </mat-expansion-panel-header>
  <div class="card-body" style="padding: 0px;"> 
     <div formArrayName="completedCommentArr1" *ngFor="let x of getCompletedCommentControls1(); let j = index" >
       <div [formGroupName]="j">

        <button class="btn dropdown" (click)="showHideAccordion(j);" style="width:100%;" 
        *ngIf="(isExpanded || isShowing) || toggleHideShow || getCompletedCommentControls1().length >= 1">
          <mat-icon class="menu-button" style="float: left;">chevron_right</mat-icon> 
          <label style="float: left;">{{getViewerFirstMessage(x)}}...</label>
         </button> 
        
  <div *ngIf="j === expandedIndexx" >
    <div  formArrayName="completedCommentArr" *ngFor="let a of getCompletedCommentControls(x); let i = index" 
    style="margin-left: 10px;" > 
  <div [formGroupName]="i" style="margin-left: 30px;">
    <div class="submenu" >
    
      <div class="input-group" [ngClass]="{even: i!=0}" style="align-items: end;">
        <div class="input-group-prepend" title="Viewer" style="height: 26px;">
            <span class="input-group-text" style="line-height: unset;">
                <i class="bi bi-eye-fill"></i>
            </span>
        </div>
        <textarea cols="60" rows="1"  formControlName="viewerComments" placeholder="Enter Viewer Comment">
        </textarea>
    </div>
    <div>
    <span [ngClass]="i!=0 ? 'viewer' : 'even1'">
      {{a.value.viewerUserName}} 
     {{a.value.viewerDateTime | date:'dd-MM-YY hh:mm:ss a':'+0530'}}
    </span>  
  </div>
<div class="input-group" style="margin-left: 41px;width: 50%;align-items: end;">
  <div class="input-group-prepend" title="Inspector" style="height: 26px;">
      <span class="input-group-text" style="line-height: unset;">
          <i class="bi bi-person-fill"></i>
      </span>
  </div>
  <textarea cols="60" rows="1"  formControlName="inspectorComments" placeholder="Enter Viewer Comment"></textarea>
</div>
   
<span style="display: block;font-size: 11px;text-align: center;margin-left: -25%;">
  {{a.value.inspectorUserName}} {{a.value.inspectorDateTime | date:'dd-MM-YY hh:mm:ss a':'+0530'}}</span>  
           
        </div>
        </div>
      </div> 
      </div>
     </div>
    </div>
      </div>   
  
</mat-expansion-panel>
<!-- completed comments end--> 
      </mat-accordion>
     
      <div *ngIf="validationError" style="text-align: center;margin-top: 30px;">
        <span class="alert alert-danger">{{validationErrorMsg}}</span>
      </div>
      <div *ngIf="commentSuccess" style="text-align: center;margin-top: 30px;">
        <span class="successshow">Your comment has been sent to Inspector</span>
      </div>
      <div *ngIf="commentApprove" style="text-align: center;margin-top: 30px;">
        <span class="alert alert-success">Your response to comments has been approved</span>
      </div>
      <div *ngIf="commentReject" style="text-align: center;margin-top: 30px;">
        <span class="alert alert-danger">Your response to comments has been rejected</span>
      </div>
      <br>
      <div class="row" style="margin-top: 20px;">
        <!-- <button class="previous" mat-button matStepperPrevious>&laquo; Back</button> -->
        <button class="next" (click)="gotoNextModal(content1,content2)"
        mat-button>Next &raquo;</button>
      </div>

    </form>

    </div>
  </div>
  <ng-template #content1 let-modal>
  <mat-progress-spinner style="margin: 0 auto;" *ngIf="finalSpinner"
    color="primary"
    [mode]="mode"
    value="50"
    diameter="50">
    </mat-progress-spinner>
    <br>
    <div *ngIf="finalSpinner" style="text-align: center;">
      Basic Information Save in Progress!
    </div>
  <div class="modal-body" *ngIf="popup">
   <div class="centre-text m-btm30">
    <div *ngIf="success" style="text-align: center;">
      <span class="successshow">{{successMsg}}</span>
     </div>
     <div *ngIf="Error" style="text-align: center;">
       <span class="errorshow">{{errorMsg}}</span>
      </div>
    </div>
   </div>
  <br>
     <button type="button" class="close" class="btn btn-block btn-primary btn-rounded btn-md font-weight-medium auth-form-btn"
     aria-label="Close"  (click)="closeModalDialog()" matStepperNext>
      <span aria-hidden="true">Ok</span>
  </button>
  </ng-template>

  <ng-template #content2 let-modal>
    <div class="modal-body">
     <div class="centre-text m-btm30">
      <div style="text-align: center;">
        <span class="successshow">Are you sure you want to procced? </span>
        <br>
        <span style="font-size: 12px;">Note: Please verify all the details! </span>
       </div>
      </div>
     </div>
    <br>
    <div class="row">
       <button type="button" class="col-md-6" style="text-align:center; width: auto;" class="btn btn-primary btn-rounded btn-md font-weight-medium auth-form-btn"
       aria-label="Close" (click)="closeModalDialog()" matStepperNext>
       <i class="bi bi-arrow-right-circle"></i>&nbsp;
        <span aria-hidden="true">Ok</span>
    </button>
    <button type="button" class="col-md-6" style="width: auto;" class="btn btn-danger btn-rounded btn-md font-weight-medium auth-form-btn"
       aria-label="Close" (click)="closeModalDialog()">
       <i class="bi bi-x icon"></i>
        <span aria-hidden="true">Cancel</span>
    </button>
  </div>
    </ng-template> 

    <!-- <ng-template #contentSig let-modal>
      <div class="modal-body">
        <div class="signature-container">
          <signature-pad [options]="signaturePadOptions"></signature-pad>
        </div>
     
        <div class="buttons">
          <button (click)="clearSignature()">Clear signature pad</button>
          <button (click)="savePad()">Save signature</button>
        </div>
      
       </div>
      </ng-template>   -->